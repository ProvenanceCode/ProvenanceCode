{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"ProvenanceCode","text":""},{"location":"#decision-driven-development-for-the-ai-era","title":"Decision-Driven Development for the AI Era","text":"<p>Traceable AI-assisted decisions. Enforced at merge time.</p>"},{"location":"#the-problem","title":"The Problem","text":"<p>AI coding agents have increased development velocity.</p> <p>They have also increased:</p> <ul> <li>Untraceable architectural decisions</li> <li>Undocumented AI influence</li> <li>Review ambiguity</li> <li>Governance gaps</li> <li>Enterprise risk</li> </ul> <p>Most organizations cannot answer:</p> <p>Why does this code exist? Was AI involved? Who approved the decision? What risk was acknowledged?</p> <p>Velocity without accountability is fragile.</p>"},{"location":"#the-solution","title":"The Solution","text":"<p>ProvenanceCode is a decision-driven development standard for AI-assisted software.</p> <p>It defines how teams:</p> <ul> <li>Capture structured decision records</li> <li>Link code to documented intent</li> <li>Enforce review checkpoints</li> <li>Surface risk and tradeoffs</li> <li>Maintain auditability without slowing delivery</li> </ul> <p>ProvenanceCode operates at the pull request layer.</p> <p>It does not replace tools. It governs them.</p>"},{"location":"#how-it-works","title":"How It Works","text":"<ol> <li>Decision Records</li> <li>Structured decision artifacts (Decision Evidence Objects)</li> <li>Stored in the repository</li> <li> <p>Linked to code changes</p> </li> <li> <p>Enforcement Presets</p> </li> <li>Light</li> <li>Standard</li> <li>Regulated</li> <li> <p>Configurable governance depth</p> </li> <li> <p>Merge-Time Validation</p> </li> <li>Pull request hooks</li> <li>Missing decisions fail validation</li> <li> <p>Unapproved decisions block merge (configurable)</p> </li> <li> <p>Human-in-the-Loop Control</p> </li> <li>AI may propose</li> <li>Humans approve</li> <li>Decisions are recorded</li> </ol>"},{"location":"#get-started","title":"Get Started","text":"<ul> <li>Read the Standard: Standard \u2192 Overview</li> <li>Implement enforcement: Implementation \u2192 GitHub Action</li> <li>Product path: Implementation \u2192 GitHub App</li> </ul> <p>ProvenanceCode is developed and maintained by EmbankAI.</p>"},{"location":"building-implementations/","title":"Building ProvenanceCode Implementations","text":"<p>Want to build a ProvenanceCode validator? This guide helps you create compliant implementations.</p>"},{"location":"building-implementations/#quick-start","title":"Quick Start","text":""},{"location":"building-implementations/#minimum-requirements","title":"Minimum Requirements","text":"<p>A compliant ProvenanceCode implementation MUST:</p> <ol> <li>Validate JSON structure against official schemas</li> <li>Check decision ID format (<code>DEC-XXXXXX</code>)</li> <li>Verify required fields (see spec)</li> <li>Support enforcement presets (light, standard, regulated)</li> <li>Provide clear feedback to users</li> </ol>"},{"location":"building-implementations/#recommended-features","title":"Recommended Features","text":"<p>Your implementation SHOULD:</p> <ol> <li>Post-validation results as comments (if on PR platforms)</li> <li>Create status checks (pass/fail indicators)</li> <li>Link to decision files for easy access</li> <li>Suggest fixes when validation fails</li> <li>Support all file types (decisions, specs, risks, mistakes)</li> </ol>"},{"location":"building-implementations/#optional-enhancements","title":"Optional Enhancements","text":"<p>Consider adding:</p> <ul> <li>Auto-draft creation for missing decisions</li> <li>Web UI for browsing decisions</li> <li>Analytics and reporting</li> <li>Cross-repository validation</li> <li>Integration with issue trackers</li> <li>IDE plugins</li> </ul>"},{"location":"building-implementations/#architecture-patterns","title":"Architecture Patterns","text":""},{"location":"building-implementations/#pattern-1-cicd-validator","title":"Pattern 1: CI/CD Validator","text":"<p>Use Case: Validate on pull requests in CI/CD pipelines</p> <p>Flow: <pre><code>1. PR opened/updated\n2. CI job triggered\n3. Validator fetches changed files\n4. Check enforcement rules\n5. Validate required artifacts\n6. Post results &amp; status\n</code></pre></p> <p>Examples: GitHub Actions, GitLab CI, CircleCI</p> <p>Pros: Simple, no hosting, free Cons: Limited features, runs after push</p>"},{"location":"building-implementations/#pattern-2-webhook-based-app","title":"Pattern 2: Webhook-Based App","text":"<p>Use Case: Real-time validation with advanced features</p> <p>Flow: <pre><code>1. PR opened/updated \u2192 Webhook sent\n2. Server receives webhook\n3. Fetch repo contents via API\n4. Run validation\n5. Post results via API\n6. Store state (optional)\n</code></pre></p> <p>Examples: GitHub Apps, GitLab Apps, Bitbucket Apps</p> <p>Pros: Real-time, advanced features, proactive Cons: Requires hosting, more complex</p>"},{"location":"building-implementations/#pattern-3-cli-tool","title":"Pattern 3: CLI Tool","text":"<p>Use Case: Local validation, pre-commit hooks</p> <p>Flow: <pre><code>1. Developer runs command\n2. Tool scans local files\n3. Validates structure\n4. Prints results\n5. Exit code (0 = pass)\n</code></pre></p> <p>Examples: <code>provenancecode-validate</code>, pre-commit hooks</p> <p>Pros: Fast feedback, no network Cons: Requires local install, no enforcement</p>"},{"location":"building-implementations/#pattern-4-ide-extension","title":"Pattern 4: IDE Extension","text":"<p>Use Case: Real-time feedback while writing</p> <p>Flow: <pre><code>1. Developer edits decision file\n2. Extension watches file\n3. Validates on save\n4. Shows inline errors\n5. Offers quick fixes\n</code></pre></p> <p>Examples: VS Code extensions, JetBrains plugins</p> <p>Pros: Best DX, immediate feedback Cons: Per-IDE development, limited scope</p>"},{"location":"building-implementations/#core-validation-logic","title":"Core Validation Logic","text":""},{"location":"building-implementations/#1-load-configuration","title":"1. Load Configuration","text":"<pre><code>async function loadConfig(repoPath) {\n  const configPath = `${repoPath}/provenance/config.json`;\n  const config = JSON.parse(await readFile(configPath));\n\n  // Merge with defaults\n  return {\n    enforcement: config.enforcement || 'standard',\n    requireDecisionOnPaths: config.requireDecisionOnPaths || [],\n    requireDecisionOnLabels: config.requireDecisionOnLabels || [],\n    ...config\n  };\n}\n</code></pre>"},{"location":"building-implementations/#2-scan-for-artifacts","title":"2. Scan for Artifacts","text":"<pre><code>async function scanDecisions(repoPath) {\n  const decisionsPath = `${repoPath}/provenance/decisions`;\n  const dirs = await listDirectories(decisionsPath);\n\n  const decisions = [];\n\n  for (const dir of dirs) {\n    if (!/^DEC-\\d{6}$/.test(dir)) continue;\n\n    const jsonPath = `${decisionsPath}/${dir}/decision.json`;\n    if (await fileExists(jsonPath)) {\n      const data = JSON.parse(await readFile(jsonPath));\n      decisions.push({ id: dir, path: jsonPath, data });\n    }\n  }\n\n  return decisions;\n}\n</code></pre>"},{"location":"building-implementations/#3-validate-structure","title":"3. Validate Structure","text":"<pre><code>function validateDecision(decision) {\n  const errors = [];\n  const warnings = [];\n\n  // Required fields\n  const required = [\n    'schema', 'id', 'title', 'version',\n    'lifecycle', 'timestamps', 'actors',\n    'outcome', 'rationale', 'risk'\n  ];\n\n  for (const field of required) {\n    if (!decision[field]) {\n      errors.push(`Missing required field: ${field}`);\n    }\n  }\n\n  // ID format\n  if (!/^DEC-\\d{6}$/.test(decision.id)) {\n    errors.push('Invalid ID format (must be DEC-XXXXXX)');\n  }\n\n  // Schema version\n  if (decision.schema !== 'provenancecode.decision.v1') {\n    errors.push('Invalid schema version');\n  }\n\n  // Lifecycle state\n  const validStates = ['draft', 'proposed', 'accepted', 'rejected', 'superseded'];\n  if (!validStates.includes(decision.lifecycle?.state)) {\n    errors.push('Invalid lifecycle state');\n  }\n\n  // Timestamps\n  if (!isValidISO8601(decision.timestamps?.created_at)) {\n    errors.push('Invalid created_at timestamp');\n  }\n\n  // Risk level\n  const validRiskLevels = ['low', 'medium', 'high', 'critical'];\n  if (!validRiskLevels.includes(decision.risk?.level)) {\n    errors.push('Invalid risk level');\n  }\n\n  // Warnings\n  if (!decision.options || decision.options.length === 0) {\n    warnings.push('No alternatives listed in options');\n  }\n\n  if (!decision.problem) {\n    warnings.push('No problem statement provided');\n  }\n\n  return { valid: errors.length === 0, errors, warnings };\n}\n</code></pre>"},{"location":"building-implementations/#4-apply-enforcement-rules","title":"4. Apply Enforcement Rules","text":"<pre><code>function checkEnforcement(config, changedFiles, prLabels, decisions) {\n  const enforcement = config.enforcement;\n  let required = false;\n\n  // Check paths\n  for (const file of changedFiles) {\n    for (const pattern of config.requireDecisionOnPaths) {\n      if (file.startsWith(pattern)) {\n        required = true;\n        break;\n      }\n    }\n  }\n\n  // Check labels\n  for (const label of prLabels) {\n    if (config.requireDecisionOnLabels.includes(label)) {\n      required = true;\n      break;\n    }\n  }\n\n  if (!required) {\n    return { required: false, blocking: false };\n  }\n\n  // Apply preset rules\n  if (enforcement === 'light') {\n    return { required: true, blocking: false };\n  }\n\n  if (enforcement === 'standard') {\n    // Block on specific labels only\n    const blockingLabels = ['breaking-change', 'architecture', 'security'];\n    const hasBlockingLabel = prLabels.some(l =&gt; blockingLabels.includes(l));\n    return { required: true, blocking: hasBlockingLabel };\n  }\n\n  if (enforcement === 'regulated') {\n    return { required: true, blocking: true };\n  }\n\n  return { required: false, blocking: false };\n}\n</code></pre>"},{"location":"building-implementations/#5-generate-results","title":"5. Generate Results","text":"<pre><code>function generateResults(decisions, enforcement, validations) {\n  const passed = validations.every(v =&gt; v.valid);\n\n  let status = 'success';\n  let message = 'All checks passed';\n\n  if (!passed) {\n    if (enforcement.blocking) {\n      status = 'failure';\n      message = 'Validation failed';\n    } else {\n      status = 'warning';\n      message = 'Validation issues found';\n    }\n  }\n\n  return {\n    status,\n    message,\n    summary: {\n      decisions_found: decisions.length,\n      decisions_required: enforcement.required ? 1 : 0,\n      errors: validations.flatMap(v =&gt; v.errors),\n      warnings: validations.flatMap(v =&gt; v.warnings)\n    },\n    details: validations\n  };\n}\n</code></pre>"},{"location":"building-implementations/#json-schemas","title":"JSON Schemas","text":"<p>Use these schemas for validation:</p> <p>Decision Schema: <code>provenancecode.decision.v1</code></p> <p>Available at: <code>https://schemas.provenancecode.org/v1/decision.json</code></p> <pre><code>{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"type\": \"object\",\n  \"required\": [\n    \"schema\", \"id\", \"title\", \"version\", \"lifecycle\",\n    \"timestamps\", \"actors\", \"outcome\", \"rationale\", \"risk\"\n  ],\n  \"properties\": {\n    \"schema\": {\n      \"type\": \"string\",\n      \"const\": \"provenancecode.decision.v1\"\n    },\n    \"id\": {\n      \"type\": \"string\",\n      \"pattern\": \"^DEC-\\\\d{6}$\"\n    },\n    \"title\": {\n      \"type\": \"string\",\n      \"maxLength\": 120\n    },\n    \"version\": {\n      \"type\": \"integer\",\n      \"minimum\": 1\n    },\n    \"lifecycle\": {\n      \"type\": \"object\",\n      \"required\": [\"state\"],\n      \"properties\": {\n        \"state\": {\n          \"enum\": [\"draft\", \"proposed\", \"accepted\", \"rejected\", \"superseded\"]\n        },\n        \"supersedes\": { \"type\": \"string\" },\n        \"superseded_by\": { \"type\": \"string\" }\n      }\n    },\n    \"timestamps\": {\n      \"type\": \"object\",\n      \"required\": [\"created_at\"],\n      \"properties\": {\n        \"created_at\": { \"type\": \"string\", \"format\": \"date-time\" },\n        \"accepted_at\": { \"type\": \"string\", \"format\": \"date-time\" },\n        \"updated_at\": { \"type\": \"string\", \"format\": \"date-time\" },\n        \"expires_at\": { \"type\": \"string\", \"format\": \"date-time\" }\n      }\n    },\n    \"actors\": {\n      \"type\": \"object\",\n      \"required\": [\"author\"],\n      \"properties\": {\n        \"author\": { \"type\": \"string\" },\n        \"approver\": { \"type\": \"string\" },\n        \"bot\": { \"type\": \"string\" },\n        \"reviewers\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } }\n      }\n    },\n    \"outcome\": { \"type\": \"string\" },\n    \"rationale\": { \"type\": \"string\" },\n    \"risk\": {\n      \"type\": \"object\",\n      \"required\": [\"level\"],\n      \"properties\": {\n        \"level\": { \"enum\": [\"low\", \"medium\", \"high\", \"critical\"] },\n        \"description\": { \"type\": \"string\" },\n        \"acceptance\": { \"type\": \"string\" },\n        \"mitigations\": { \"type\": \"array\", \"items\": { \"type\": \"string\" } }\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"building-implementations/#testing-your-implementation","title":"Testing Your Implementation","text":""},{"location":"building-implementations/#test-cases","title":"Test Cases","text":"<p>Create test repositories with these scenarios:</p> <p>\u2705 Valid Cases: 1. Minimal valid decision 2. Complete decision with all fields 3. Multiple decisions in PR 4. Decision with links and references</p> <p>\u274c Invalid Cases: 1. Missing required fields 2. Invalid ID format 3. Invalid lifecycle state 4. Invalid timestamp format 5. Missing decision when required</p> <p>\u26a0\ufe0f Edge Cases: 1. Empty decisions directory 2. Superseded decisions 3. Multiple versions of same decision 4. Circular supersession links</p>"},{"location":"building-implementations/#compliance-checklist","title":"Compliance Checklist","text":"<p>Before releasing, verify:</p> <ul> <li>[ ] Validates against official JSON schema</li> <li>[ ] Checks all required fields</li> <li>[ ] Validates ID format (DEC-XXXXXX)</li> <li>[ ] Supports all enforcement presets</li> <li>[ ] Handles missing files gracefully</li> <li>[ ] Provides clear error messages</li> <li>[ ] Links back to ProvenanceCode standard</li> <li>[ ] Has documentation for users</li> <li>[ ] Handles superseded decisions</li> <li>[ ] Validates timestamp formats</li> <li>[ ] Checks lifecycle states</li> </ul>"},{"location":"building-implementations/#platform-specific-guides","title":"Platform-Specific Guides","text":""},{"location":"building-implementations/#github-actions","title":"GitHub Actions","text":"<p>See GitHub Actions implementation guide</p>"},{"location":"building-implementations/#gitlab-ci","title":"GitLab CI","text":"<pre><code>provenancecode-validation:\n  stage: test\n  script:\n    - npm install -g @provenancecode/validator\n    - provenancecode-validate\n  only:\n    - merge_requests\n</code></pre>"},{"location":"building-implementations/#circleci","title":"CircleCI","text":"<pre><code>version: 2.1\njobs:\n  validate:\n    docker:\n      - image: node:18\n    steps:\n      - checkout\n      - run: npm install -g @provenancecode/validator\n      - run: provenancecode-validate\nworkflows:\n  pr-validation:\n    jobs:\n      - validate\n</code></pre>"},{"location":"building-implementations/#bitbucket-pipelines","title":"Bitbucket Pipelines","text":"<pre><code>pipelines:\n  pull-requests:\n    '**':\n      - step:\n          name: ProvenanceCode Validation\n          script:\n            - npm install -g @provenancecode/validator\n            - provenancecode-validate\n</code></pre>"},{"location":"building-implementations/#publishing-your-implementation","title":"Publishing Your Implementation","text":""},{"location":"building-implementations/#1-document-it","title":"1. Document It","text":"<p>Create clear documentation: - Installation instructions - Configuration options - Usage examples - Troubleshooting guide</p>"},{"location":"building-implementations/#2-license-it","title":"2. License It","text":"<p>Choose an appropriate license: - Open source: Apache 2.0, MIT, GPL, etc. - Commercial: Your choice - Dual license: Offer both</p>"},{"location":"building-implementations/#3-share-it","title":"3. Share It","text":"<ul> <li>Submit PR to add it to Implementations</li> <li>Tag it: <code>provenancecode-implementation</code></li> <li>Tweet with #ProvenanceCode</li> <li>Post on relevant forums</li> </ul>"},{"location":"building-implementations/#4-get-feedback","title":"4. Get Feedback","text":"<ul> <li>Enable GitHub Issues</li> <li>Join community discussions</li> <li>Iterate based on user feedback</li> </ul>"},{"location":"building-implementations/#support","title":"Support","text":""},{"location":"building-implementations/#questions","title":"Questions?","text":"<ul> <li>Spec questions: GitHub Issues</li> <li>Implementation help: Discussions</li> <li>Community: Join our community channels</li> </ul>"},{"location":"building-implementations/#found-an-ambiguity","title":"Found an Ambiguity?","text":"<p>If the specification is unclear, please: 1. Open an issue describing the ambiguity 2. Propose clarification 3. We'll update the spec for everyone</p> <p>Ready to build? Start with the Standard Overview and DEO Specification.</p>"},{"location":"implementations/","title":"Implementations","text":"<p>ProvenanceCode is an open standard. Multiple implementations exist, and you can build your own.</p>"},{"location":"implementations/#official-implementations","title":"Official Implementations","text":""},{"location":"implementations/#1-github-actions-validator-open-source","title":"1. GitHub Actions Validator (Open Source)","text":"<p>Status: \u2705 Available License: Apache 2.0 Cost: Free Type: Self-hosted CI/CD</p> <p>Features: - Validates decisions, specs, and risks on pull requests - Posts validation results as PR comments - Creates status checks for branch protection - Configurable enforcement presets - No external dependencies</p> <p>Best for: Teams wanting a simple, free, open-source solution</p> <p>Get Started: GitHub Actions Guide</p>"},{"location":"implementations/#2-provenancecode-app-commercial","title":"2. ProvenanceCode App (Commercial)","text":"<p>Status: \ud83d\udea7 In Development Provider: EmbankAI License: Proprietary Cost: Free for open source, paid for private repos Type: Managed SaaS</p> <p>Features: - Everything in GitHub Actions, plus: - \u2728 Auto-create decision drafts - \u2728 Web UI for decision management - \u2728 Cross-repository validation - \u2728 Team-based access controls - \u2728 Real-time validation feedback - \u2728 Enterprise support &amp; SLA - \u2728 SOC 2 compliant hosting</p> <p>Best for: Teams wanting zero-setup managed solution with advanced features</p> <p>Get Started: ProvenanceCode App</p>"},{"location":"implementations/#community-implementations","title":"Community Implementations","text":"<p>We encourage the community to build implementations. If you've built one, please submit a PR to add it here!</p>"},{"location":"implementations/#build-your-own","title":"Build Your Own","text":"<p>ProvenanceCode is designed to be implementable by any team or vendor. Possible implementations:</p> <p>CI/CD Integrations: - GitLab CI validator - CircleCI orb - Jenkins plugin - Azure DevOps extension - Bitbucket Pipes</p> <p>IDE Extensions: - VS Code extension for decision drafts - JetBrains plugin - Cursor rules integration</p> <p>CLI Tools: - Standalone validator CLI - Pre-commit hooks - Git extensions</p> <p>Web Services: - Decision browsing UI - Analytics dashboards - Compliance reporting</p> <p>Want to build an implementation? See our Building Implementations Guide</p>"},{"location":"implementations/#implementation-compliance","title":"Implementation Compliance","text":"<p>All implementations should:</p> <ol> <li>Validate against the spec - Use the official JSON schemas</li> <li>Support enforcement presets - Light, Standard, Regulated</li> <li>Provide clear feedback - Help users understand validation results</li> <li>Link to the standard - Reference ProvenanceCode.org in output</li> <li>Be documented - Help users get started</li> </ol>"},{"location":"implementations/#certification-future","title":"Certification (Future)","text":"<p>We may introduce an optional compliance certification program to help users identify fully-compliant implementations.</p>"},{"location":"implementations/#license-compatibility","title":"License Compatibility","text":"<p>The ProvenanceCode standard is licensed under Apache 2.0, which permits:</p> <ul> <li>\u2705 Open source implementations (any OSI-approved license)</li> <li>\u2705 Proprietary/commercial implementations</li> <li>\u2705 SaaS offerings</li> <li>\u2705 Embedded in other products</li> <li>\u2705 Modifications and derivatives</li> </ul> <p>You do NOT need permission to build an implementation. You SHOULD link back to the standard for clarity.</p>"},{"location":"implementations/#contributing","title":"Contributing","text":""},{"location":"implementations/#report-implementation-issues","title":"Report Implementation Issues","text":"<p>If you encounter issues implementing the standard, please: 1. Open an issue in the ProvenanceCode repository 2. Describe the ambiguity or difficulty 3. Suggest clarifications</p> <p>Your feedback helps improve the standard for everyone.</p>"},{"location":"implementations/#share-your-implementation","title":"Share Your Implementation","text":"<p>Built an implementation? Let us know! - Submit a PR adding it to this page - Tag it with <code>provenancecode-implementation</code> - Share on social media with #ProvenanceCode</p>"},{"location":"implementations/#vendor-neutrality","title":"Vendor Neutrality","text":"<p>The ProvenanceCode standard is vendor-neutral. All implementations are equal in the eyes of the spec.</p> <p>EmbankAI, as the initial steward, may offer commercial services, but: - \u2705 The standard remains open - \u2705 Community implementations are welcomed - \u2705 No preferential treatment in the spec</p> <p>If you believe there's bias in the standard, please raise it via GitHub Issues.</p> <p>Ready to adopt ProvenanceCode? Start with GitHub Actions for a free, open-source implementation.</p>"},{"location":"implementation/github-action/","title":"GitHub Actions Implementation","text":"<p>Version: 1.0.0 Status: Draft Part of: ProvenanceCode Open Standard Implementation Type: Open Source / Self-Hosted</p>"},{"location":"implementation/github-action/#abstract","title":"Abstract","text":"<p>This guide shows how to implement ProvenanceCode validation using GitHub Actions - a free, open-source approach. This is the recommended starting point for most teams adopting ProvenanceCode.</p>"},{"location":"implementation/github-action/#why-start-here","title":"Why Start Here?","text":"<ul> <li>\u2705 100% Free for public and private repos</li> <li>\u2705 No external dependencies - runs entirely in GitHub</li> <li>\u2705 Simple setup - add one workflow file</li> <li>\u2705 Full standard compliance - validates all ProvenanceCode requirements</li> <li>\u2705 No vendor lock-in - you control everything</li> </ul>"},{"location":"implementation/github-action/#when-to-consider-alternatives","title":"When to Consider Alternatives","text":"<p>If you need advanced features like auto-draft creation, cross-repo validation, or a web UI, see the GitHub App implementation or build your own custom validator.</p>"},{"location":"implementation/github-action/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Prerequisites</li> <li>Basic Workflow Setup</li> <li>Workflow Configuration</li> <li>Validation Triggers</li> <li>Environment Variables</li> <li>PR Comment Integration</li> <li>Status Checks</li> <li>Advanced Patterns</li> <li>Troubleshooting</li> </ol>"},{"location":"implementation/github-action/#overview","title":"Overview","text":"<p>GitHub Actions provides a native way to validate ProvenanceCode compliance on every pull request. The validator runs in CI/CD, checks for required decisions, specs, and risks, and reports results directly in the PR.</p>"},{"location":"implementation/github-action/#benefits","title":"Benefits","text":"<ul> <li>Automated Validation - Every PR is checked automatically</li> <li>Clear Feedback - Results appear as PR comments and status checks</li> <li>Branch Protection - Block merges that don't meet requirements</li> <li>No External Services - Runs entirely within GitHub</li> <li>Free for Public Repos - Included in GitHub's free tier</li> </ul>"},{"location":"implementation/github-action/#prerequisites","title":"Prerequisites","text":""},{"location":"implementation/github-action/#required","title":"Required","text":"<ol> <li>GitHub Repository with Actions enabled</li> <li>ProvenanceCode Structure installed (see Getting Started)</li> <li>Configuration Files:</li> <li><code>provenance/config.json</code></li> <li><code>provenance/policies/enforcement.yml</code></li> </ol>"},{"location":"implementation/github-action/#optional","title":"Optional","text":"<ol> <li>Branch Protection rules for enforcement</li> <li>CODEOWNERS file for decision approval</li> <li>PR Template for decision references</li> </ol>"},{"location":"implementation/github-action/#basic-workflow-setup","title":"Basic Workflow Setup","text":""},{"location":"implementation/github-action/#step-1-create-workflow-file","title":"Step 1: Create Workflow File","text":"<p>Create <code>.github/workflows/provenance-check.yml</code>:</p> <pre><code>name: ProvenanceCode Validation\n\non:\n  pull_request:\n    types: [opened, synchronize, reopened]\n    branches:\n      - main\n      - develop\n\njobs:\n  validate:\n    name: Validate Decision Evidence\n    runs-on: ubuntu-latest\n\n    steps:\n      - name: Checkout code\n        uses: actions/checkout@v4\n        with:\n          fetch-depth: 0  # Full history for diff analysis\n\n      - name: Setup Node.js\n        uses: actions/setup-node@v4\n        with:\n          node-version: '18'\n\n      - name: Install ProvenanceCode Validator\n        run: npm install -g @provenancecode/validator\n\n      - name: Validate ProvenanceCode\n        env:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n        run: provenancecode-validate\n</code></pre>"},{"location":"implementation/github-action/#step-2-commit-and-push","title":"Step 2: Commit and Push","text":"<pre><code>git add .github/workflows/provenance-check.yml\ngit commit -m \"Add ProvenanceCode validation workflow\"\ngit push origin main\n</code></pre>"},{"location":"implementation/github-action/#step-3-test","title":"Step 3: Test","text":"<p>Create a test PR that modifies a file in a path requiring a decision (e.g., <code>src/</code>) and verify the workflow runs.</p>"},{"location":"implementation/github-action/#workflow-configuration","title":"Workflow Configuration","text":""},{"location":"implementation/github-action/#complete-workflow-example","title":"Complete Workflow Example","text":"<pre><code>name: ProvenanceCode Validation\n\non:\n  pull_request:\n    types: [opened, synchronize, reopened, edited]\n    branches:\n      - main\n      - develop\n      - 'release/**'\n\npermissions:\n  contents: read\n  pull-requests: write  # For posting comments\n  checks: write         # For status checks\n\njobs:\n  validate:\n    name: Validate Decision Evidence\n    runs-on: ubuntu-latest\n    timeout-minutes: 10\n\n    steps:\n      - name: Checkout PR head\n        uses: actions/checkout@v4\n        with:\n          ref: ${{ github.event.pull_request.head.sha }}\n          fetch-depth: 0\n\n      - name: Checkout base branch\n        run: |\n          git fetch origin ${{ github.event.pull_request.base.ref }}\n          git checkout ${{ github.event.pull_request.base.sha }}\n          git checkout -\n\n      - name: Setup Node.js\n        uses: actions/setup-node@v4\n        with:\n          node-version: '18'\n          cache: 'npm'\n\n      - name: Install validator\n        run: npm install -g @provenancecode/validator\n\n      - name: Run validation\n        id: validate\n        env:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n          PROVENANCE_PR_NUMBER: ${{ github.event.pull_request.number }}\n          PROVENANCE_PR_TITLE: ${{ github.event.pull_request.title }}\n          PROVENANCE_PR_BODY: ${{ github.event.pull_request.body }}\n          PROVENANCE_PR_URL: ${{ github.event.pull_request.html_url }}\n          PROVENANCE_BASE_REF: ${{ github.event.pull_request.base.sha }}\n          PROVENANCE_HEAD_REF: ${{ github.event.pull_request.head.sha }}\n          PROVENANCE_LABELS: ${{ join(github.event.pull_request.labels.*.name, ',') }}\n        run: |\n          provenancecode-validate \\\n            --format json \\\n            --output validation-results.json\n\n      - name: Post PR comment\n        if: always()\n        uses: actions/github-script@v7\n        with:\n          github-token: ${{ secrets.GITHUB_TOKEN }}\n          script: |\n            const fs = require('fs');\n            const results = JSON.parse(fs.readFileSync('validation-results.json', 'utf8'));\n\n            let comment = '## ProvenanceCode Validation Results\\n\\n';\n\n            if (results.valid) {\n              comment += '\u2705 **All checks passed**\\n\\n';\n            } else {\n              comment += '\u274c **Validation failed**\\n\\n';\n            }\n\n            comment += '### Summary\\n\\n';\n            comment += `- **Decisions:** ${results.decisions.found}/${results.decisions.required}\\n`;\n            comment += `- **Specs:** ${results.specs.found}/${results.specs.required}\\n`;\n            comment += `- **Risks:** ${results.risks.found}/${results.risks.required}\\n\\n`;\n\n            if (results.errors.length &gt; 0) {\n              comment += '### Errors\\n\\n';\n              results.errors.forEach(err =&gt; {\n                comment += `- \u274c ${err}\\n`;\n              });\n              comment += '\\n';\n            }\n\n            if (results.warnings.length &gt; 0) {\n              comment += '### Warnings\\n\\n';\n              results.warnings.forEach(warn =&gt; {\n                comment += `- \u26a0\ufe0f ${warn}\\n`;\n              });\n              comment += '\\n';\n            }\n\n            comment += '---\\n';\n            comment += `[Documentation](https://provenancecode.org/docs) | [Guide](https://provenancecode.org/guides/getting-started)`;\n\n            // Find existing comment\n            const { data: comments } = await github.rest.issues.listComments({\n              owner: context.repo.owner,\n              repo: context.repo.repo,\n              issue_number: context.issue.number,\n            });\n\n            const botComment = comments.find(c =&gt; \n              c.user.type === 'Bot' &amp;&amp; \n              c.body.includes('ProvenanceCode Validation Results')\n            );\n\n            if (botComment) {\n              // Update existing comment\n              await github.rest.issues.updateComment({\n                owner: context.repo.owner,\n                repo: context.repo.repo,\n                comment_id: botComment.id,\n                body: comment\n              });\n            } else {\n              // Create new comment\n              await github.rest.issues.createComment({\n                owner: context.repo.owner,\n                repo: context.repo.repo,\n                issue_number: context.issue.number,\n                body: comment\n              });\n            }\n\n      - name: Upload validation results\n        if: always()\n        uses: actions/upload-artifact@v4\n        with:\n          name: provenance-validation-results\n          path: validation-results.json\n          retention-days: 30\n\n      - name: Set status\n        if: failure()\n        run: exit 1\n</code></pre>"},{"location":"implementation/github-action/#validation-triggers","title":"Validation Triggers","text":""},{"location":"implementation/github-action/#when-to-run-validation","title":"When to Run Validation","text":""},{"location":"implementation/github-action/#pull-request-events","title":"Pull Request Events","text":"<pre><code>on:\n  pull_request:\n    types:\n      - opened        # New PR created\n      - synchronize   # New commits pushed\n      - reopened      # PR reopened\n      - edited        # PR title/body edited (important for decision IDs)\n</code></pre>"},{"location":"implementation/github-action/#branch-filters","title":"Branch Filters","text":"<pre><code>on:\n  pull_request:\n    branches:\n      - main\n      - develop\n      - 'release/**'\n    # Optionally exclude certain branches\n    branches-ignore:\n      - 'docs/**'\n      - 'dependabot/**'\n</code></pre>"},{"location":"implementation/github-action/#path-filters","title":"Path Filters","text":"<p>Skip validation for non-code changes:</p> <pre><code>on:\n  pull_request:\n    paths-ignore:\n      - '**.md'\n      - 'docs/**'\n      - '.github/**'\n      - 'LICENSE'\n</code></pre> <p>Note: Path filters are optional. ProvenanceCode's own config handles docs-only detection.</p>"},{"location":"implementation/github-action/#environment-variables","title":"Environment Variables","text":""},{"location":"implementation/github-action/#required-variables","title":"Required Variables","text":"Variable Source Purpose <code>GITHUB_TOKEN</code> <code>${{ secrets.GITHUB_TOKEN }}</code> API access for PR data"},{"location":"implementation/github-action/#optional-variables","title":"Optional Variables","text":"Variable Source Purpose <code>PROVENANCE_PR_NUMBER</code> <code>${{ github.event.pull_request.number }}</code> PR number for validation <code>PROVENANCE_PR_TITLE</code> <code>${{ github.event.pull_request.title }}</code> Extract decision IDs from title <code>PROVENANCE_PR_BODY</code> <code>${{ github.event.pull_request.body }}</code> Extract decision IDs from description <code>PROVENANCE_PR_URL</code> <code>${{ github.event.pull_request.html_url }}</code> Validate PR link in decision <code>PROVENANCE_BASE_REF</code> <code>${{ github.event.pull_request.base.sha }}</code> Base commit for diff <code>PROVENANCE_HEAD_REF</code> <code>${{ github.event.pull_request.head.sha }}</code> Head commit for diff <code>PROVENANCE_LABELS</code> <code>${{ join(github.event.pull_request.labels.*.name, ',') }}</code> PR labels for triggers"},{"location":"implementation/github-action/#configuration-override","title":"Configuration Override","text":"<p>Override config paths if needed:</p> <pre><code>env:\n  PROVENANCE_CONFIG_PATH: provenance/config.json\n  PROVENANCE_ENFORCEMENT_PATH: provenance/policies/enforcement.yml\n</code></pre>"},{"location":"implementation/github-action/#pr-comment-integration","title":"PR Comment Integration","text":""},{"location":"implementation/github-action/#basic-comment","title":"Basic Comment","text":"<p>Simple validation result:</p> <pre><code>- name: Post result comment\n  uses: actions/github-script@v7\n  with:\n    script: |\n      const comment = `\n      ## \u2705 ProvenanceCode Validation Passed\n\n      All required decision evidence is present.\n      `;\n\n      github.rest.issues.createComment({\n        issue_number: context.issue.number,\n        owner: context.repo.owner,\n        repo: context.repo.repo,\n        body: comment\n      });\n</code></pre>"},{"location":"implementation/github-action/#detailed-comment-with-results","title":"Detailed Comment with Results","text":"<pre><code>- name: Post detailed results\n  uses: actions/github-script@v7\n  with:\n    script: |\n      const fs = require('fs');\n      const results = JSON.parse(fs.readFileSync('validation-results.json'));\n\n      let comment = '## ProvenanceCode Validation\\n\\n';\n\n      // Decision section\n      comment += '### Decisions\\n';\n      if (results.decisions.found &gt; 0) {\n        results.decisions.list.forEach(dec =&gt; {\n          comment += `- \u2705 [${dec.id}](${dec.path}) - ${dec.title}\\n`;\n        });\n      } else if (results.decisions.required &gt; 0) {\n        comment += '- \u274c No decisions found (required)\\n';\n      } else {\n        comment += '- \u2139\ufe0f No decisions required\\n';\n      }\n\n      // Specs section\n      comment += '\\n### Specifications\\n';\n      if (results.specs.found &gt; 0) {\n        results.specs.list.forEach(spec =&gt; {\n          comment += `- \u2705 [${spec.id}](${spec.path}) - ${spec.title}\\n`;\n        });\n      } else {\n        comment += '- \u2139\ufe0f No specs found\\n';\n      }\n\n      // Errors and warnings\n      if (results.errors.length &gt; 0) {\n        comment += '\\n### \u274c Errors\\n';\n        results.errors.forEach(err =&gt; {\n          comment += `- ${err}\\n`;\n        });\n      }\n\n      if (results.warnings.length &gt; 0) {\n        comment += '\\n### \u26a0\ufe0f Warnings\\n';\n        results.warnings.forEach(warn =&gt; {\n          comment += `- ${warn}\\n`;\n        });\n      }\n\n      github.rest.issues.createComment({\n        issue_number: context.issue.number,\n        owner: context.repo.owner,\n        repo: context.repo.repo,\n        body: comment\n      });\n</code></pre>"},{"location":"implementation/github-action/#status-checks","title":"Status Checks","text":""},{"location":"implementation/github-action/#enable-status-check","title":"Enable Status Check","text":"<p>Add to your workflow:</p> <pre><code>- name: Report status\n  if: always()\n  uses: actions/github-script@v7\n  with:\n    script: |\n      const fs = require('fs');\n      const results = JSON.parse(fs.readFileSync('validation-results.json'));\n\n      await github.rest.repos.createCommitStatus({\n        owner: context.repo.owner,\n        repo: context.repo.repo,\n        sha: context.payload.pull_request.head.sha,\n        state: results.valid ? 'success' : 'failure',\n        context: 'ProvenanceCode Validation',\n        description: results.valid ? 'All checks passed' : 'Validation failed',\n        target_url: `${context.serverUrl}/${context.repo.owner}/${context.repo.repo}/actions/runs/${context.runId}`\n      });\n</code></pre>"},{"location":"implementation/github-action/#branch-protection","title":"Branch Protection","text":"<p>Configure branch protection to require the status check:</p> <ol> <li>Go to Settings \u2192 Branches</li> <li>Add rule for <code>main</code> branch</li> <li>Enable Require status checks to pass before merging</li> <li>Select ProvenanceCode Validation</li> <li>Save changes</li> </ol> <p>Now PRs cannot merge until validation passes.</p>"},{"location":"implementation/github-action/#advanced-patterns","title":"Advanced Patterns","text":""},{"location":"implementation/github-action/#pattern-1-forked-pr-support","title":"Pattern 1: Forked PR Support","text":"<p>Use <code>pull_request_target</code> for forks (careful - security implications):</p> <pre><code>name: ProvenanceCode Validation (Forks)\n\non:\n  pull_request_target:\n    types: [opened, synchronize]\n\njobs:\n  validate:\n    runs-on: ubuntu-latest\n\n    steps:\n      - name: Checkout base (safe)\n        uses: actions/checkout@v4\n        with:\n          ref: ${{ github.event.pull_request.base.ref }}\n\n      - name: Fetch PR files via API (no code execution)\n        env:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n        run: |\n          # Fetch changed files via API\n          # Validate without checking out untrusted code\n          provenancecode-validate --remote-only\n</code></pre>"},{"location":"implementation/github-action/#pattern-2-decision-draft-creation","title":"Pattern 2: Decision Draft Creation","text":"<p>Automatically create decision drafts for PRs:</p> <pre><code>- name: Create decision draft if missing\n  if: failure()\n  uses: actions/github-script@v7\n  with:\n    script: |\n      const fs = require('fs');\n      const path = require('path');\n\n      // Find next decision ID\n      const decisions = fs.readdirSync('provenance/decisions');\n      const maxId = Math.max(...decisions.map(d =&gt; \n        parseInt(d.replace('DEC-', ''))\n      ));\n      const nextId = `DEC-${String(maxId + 1).padStart(6, '0')}`;\n\n      // Create draft\n      const draft = {\n        schema: 'provenancecode.decision.v1',\n        id: nextId,\n        title: context.payload.pull_request.title,\n        version: 1,\n        lifecycle: { state: 'draft' },\n        timestamps: { created_at: new Date().toISOString() },\n        actors: { author: context.payload.pull_request.user.login },\n        outcome: 'TODO: Document what was decided',\n        rationale: 'TODO: Explain why',\n        risk: { level: 'low' }\n      };\n\n      const draftContent = `\n      # ${nextId}: ${draft.title}\n\n      **Status:** Draft (auto-created)\n      **Author:** ${draft.actors.author}\n      **PR:** #${context.issue.number}\n\n      ## Context\n\n      TODO: Why is this change needed?\n\n      ## Decision\n\n      TODO: What did we decide?\n\n      ## Rationale\n\n      TODO: Why this approach?\n      `;\n\n      // Post comment with draft\n      await github.rest.issues.createComment({\n        issue_number: context.issue.number,\n        owner: context.repo.owner,\n        repo: context.repo.repo,\n        body: `\n        ## \ud83d\udcdd Decision Draft Created\n\n        A decision is required for this PR. Here's a draft to get you started:\n\n        **Decision ID:** ${nextId}\n\n        \\`\\`\\`json\n        ${JSON.stringify(draft, null, 2)}\n        \\`\\`\\`\n\n        ### Next Steps\n\n        1. Copy the draft to \\`provenance/drafts/${nextId}-draft.md\\`\n        2. Fill in the TODO sections\n        3. Commit and push\n        4. Update PR title to include ${nextId}\n        `\n      });\n</code></pre>"},{"location":"implementation/github-action/#pattern-3-multiple-environments","title":"Pattern 3: Multiple Environments","text":"<p>Different validation for different branches:</p> <pre><code>jobs:\n  validate-dev:\n    if: github.event.pull_request.base.ref == 'develop'\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - run: provenancecode-validate --preset light\n\n  validate-prod:\n    if: github.event.pull_request.base.ref == 'main'\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - run: provenancecode-validate --preset standard\n</code></pre>"},{"location":"implementation/github-action/#pattern-4-parallel-validation","title":"Pattern 4: Parallel Validation","text":"<p>Run validation in parallel with tests:</p> <pre><code>jobs:\n  test:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - run: npm test\n\n  provenance:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - run: provenancecode-validate\n\n  required:\n    needs: [test, provenance]\n    runs-on: ubuntu-latest\n    steps:\n      - run: echo \"All checks passed\"\n</code></pre>"},{"location":"implementation/github-action/#troubleshooting","title":"Troubleshooting","text":""},{"location":"implementation/github-action/#issue-workflow-doesnt-run","title":"Issue: Workflow doesn't run","text":"<p>Check: - Workflow file is in <code>.github/workflows/</code> - File has <code>.yml</code> or <code>.yaml</code> extension - Actions are enabled in repository settings - Branch is included in <code>on.pull_request.branches</code></p>"},{"location":"implementation/github-action/#issue-permission-denied-errors","title":"Issue: Permission denied errors","text":"<p>Solution: Add permissions to workflow:</p> <pre><code>permissions:\n  contents: read\n  pull-requests: write\n  checks: write\n</code></pre>"},{"location":"implementation/github-action/#issue-cant-find-decision-files","title":"Issue: Can't find decision files","text":"<p>Check: - Decision folders match ID format: <code>DEC-XXXXXX</code> - <code>decision.json</code> file exists in each folder - Checkout includes <code>fetch-depth: 0</code> for full history - Base branch is checked out for diff comparison</p>"},{"location":"implementation/github-action/#issue-validation-always-passesfails","title":"Issue: Validation always passes/fails","text":"<p>Debug: <pre><code>- name: Debug validation\n  run: |\n    echo \"PR Number: ${{ github.event.pull_request.number }}\"\n    echo \"Base: ${{ github.event.pull_request.base.ref }}\"\n    echo \"Head: ${{ github.event.pull_request.head.ref }}\"\n    echo \"Labels: ${{ join(github.event.pull_request.labels.*.name, ',') }}\"\n    echo \"Changed files:\"\n    git diff --name-only ${{ github.event.pull_request.base.sha }} ${{ github.event.pull_request.head.sha }}\n    echo \"Config:\"\n    cat provenance/config.json\n</code></pre></p>"},{"location":"implementation/github-action/#issue-comment-not-posted","title":"Issue: Comment not posted","text":"<p>Check: - <code>pull-requests: write</code> permission is set - PR is not from a fork (use <code>pull_request_target</code> for forks) - GitHub token is valid - No rate limiting issues</p>"},{"location":"implementation/github-action/#examples","title":"Examples","text":"<p>See complete working examples: - Basic validation workflow - Advanced validation with comments - Forked PR support</p>"},{"location":"implementation/github-action/#next-steps","title":"Next Steps","text":"<ol> <li>Create workflow file in <code>.github/workflows/</code></li> <li>Test with a PR that modifies enforced paths</li> <li>Add branch protection to require passing checks</li> <li>Customize comments to match your team's needs</li> <li>Set up notifications for validation failures</li> </ol>"},{"location":"implementation/github-action/#related-documentation","title":"Related Documentation","text":"<ul> <li>GitHub App Implementation - Alternative implementation using GitHub Apps</li> <li>Enforcement Policies - Configure validation rules</li> <li>Getting Started - Initial setup</li> </ul> <p>See Also: - GitHub Actions Documentation - ProvenanceCode Validator</p>"},{"location":"implementation/github-app/","title":"GitHub App Implementation","text":"<p>Version: 1.0.0 Status: Draft Part of: ProvenanceCode Open Standard</p>"},{"location":"implementation/github-app/#abstract","title":"Abstract","text":"<p>This document describes how to build a GitHub App that implements ProvenanceCode validation. This is a more advanced implementation path compared to GitHub Actions, providing features like proactive decision draft creation, team-based access control, and cross-repository validation.</p>"},{"location":"implementation/github-app/#commercial-implementation-available","title":"Commercial Implementation Available","text":"<p>ProvenanceCode App by EmbankAI is a fully-managed commercial GitHub App that implements this specification. It provides:</p> <ul> <li>\u2705 Zero-setup installation</li> <li>\u2705 Automatic decision draft creation</li> <li>\u2705 Team-based access controls</li> <li>\u2705 Cross-repository validation</li> <li>\u2705 Web UI for decision management</li> <li>\u2705 Enterprise support</li> <li>\u2705 SOC 2 compliant hosting</li> </ul> <p>Pricing: Free for open source, paid plans for private repos.</p> <p>If you prefer to build your own implementation, this guide provides the technical details.</p>"},{"location":"implementation/github-app/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Architecture</li> <li>Prerequisites</li> <li>GitHub App Setup</li> <li>Server Implementation</li> <li>Webhook Handling</li> <li>Validation Logic</li> <li>UI Integration</li> <li>Access Control</li> <li>Deployment</li> <li>Advanced Features</li> </ol>"},{"location":"implementation/github-app/#overview","title":"Overview","text":"<p>A GitHub App provides a more integrated ProvenanceCode experience compared to GitHub Actions:</p>"},{"location":"implementation/github-app/#github-app-vs-github-actions","title":"GitHub App vs GitHub Actions","text":"Feature GitHub Actions GitHub App Validation on PR \u2705 Yes \u2705 Yes PR Comments \u2705 Yes \u2705 Yes Status Checks \u2705 Yes \u2705 Yes Auto-draft Creation \u26a0\ufe0f Limited \u2705 Yes Cross-repo Validation \u274c No \u2705 Yes Web UI for Decisions \u274c No \u2705 Yes Team-based Access \u274c No \u2705 Yes OAuth Integration \u274c No \u2705 Yes Real-time Notifications \u274c No \u2705 Yes Setup Complexity Low Medium Hosting Required No Yes"},{"location":"implementation/github-app/#when-to-use-github-app","title":"When to Use GitHub App","text":"<p>Choose a GitHub App when you need: - Proactive assistance - Auto-create decision drafts - Cross-repository - Validate decisions across multiple repos - Web UI - Browse and edit decisions in a web interface - Advanced access control - Team-based permissions - Real-time features - Live validation feedback</p>"},{"location":"implementation/github-app/#architecture","title":"Architecture","text":""},{"location":"implementation/github-app/#components","title":"Components","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        GitHub                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                \u2502\n\u2502  \u2502  Repository  \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524  GitHub App  \u2502                \u2502\n\u2502  \u2502              \u2502         \u2502              \u2502                \u2502\n\u2502  \u2502  - PRs       \u2502         \u2502  - Installed \u2502                \u2502\n\u2502  \u2502  - Webhooks  \u2502         \u2502  - Permissions\u2502               \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                \u2502\n\u2502         \u2502                                                   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n          \u2502 Webhooks\n          \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   ProvenanceCode Server                     \u2502\n\u2502                                                             \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502   Webhook    \u2502\u2500\u2500\u2500\u2192\u2502  Validator   \u2502\u2500\u2500\u2500\u2192\u2502   GitHub     \u2502 \u2502\n\u2502  \u2502   Handler    \u2502    \u2502   Engine     \u2502    \u2502   API        \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                             \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                     \u2502\n\u2502  \u2502   Web UI     \u2502    \u2502   Database   \u2502                     \u2502\n\u2502  \u2502  (Optional)  \u2502    \u2502  (Optional)  \u2502                     \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"implementation/github-app/#data-flow","title":"Data Flow","text":"<ol> <li>PR Created \u2192 GitHub sends webhook to server</li> <li>Server receives webhook \u2192 Extracts PR data</li> <li>Validator runs \u2192 Checks for required decisions/specs/risks</li> <li>Results returned \u2192 Posted as PR comment and status check</li> <li>User updates PR \u2192 Process repeats</li> </ol>"},{"location":"implementation/github-app/#prerequisites","title":"Prerequisites","text":""},{"location":"implementation/github-app/#required","title":"Required","text":"<ol> <li>Hosting Environment</li> <li>Node.js 18+ server</li> <li>Public HTTPS endpoint</li> <li> <p>Port 443 or custom port</p> </li> <li> <p>GitHub Account</p> </li> <li>Admin access to organization/repo</li> <li> <p>Ability to create GitHub Apps</p> </li> <li> <p>ProvenanceCode Setup</p> </li> <li>Repository with provenance structure</li> <li>Configuration files in place</li> </ol>"},{"location":"implementation/github-app/#recommended","title":"Recommended","text":"<ul> <li>Domain name with SSL certificate</li> <li>Monitoring and logging system</li> <li>Database for caching (optional)</li> <li>Redis for session management (optional)</li> </ul>"},{"location":"implementation/github-app/#github-app-setup","title":"GitHub App Setup","text":""},{"location":"implementation/github-app/#step-1-create-github-app","title":"Step 1: Create GitHub App","text":"<ol> <li> <p>Go to Settings \u2192 Developer settings \u2192 GitHub Apps \u2192 New GitHub App</p> </li> <li> <p>Basic Information:</p> </li> <li>Name: <code>ProvenanceCode Validator</code></li> <li>Homepage URL: <code>https://your-domain.com</code></li> <li>Webhook URL: <code>https://your-domain.com/webhooks</code></li> <li> <p>Webhook secret: Generate a random secret (save it)</p> </li> <li> <p>Permissions:</p> </li> </ol> <p>Repository permissions:    - Contents: <code>Read-only</code> (read decision files)    - Pull requests: <code>Read &amp; write</code> (comment and status)    - Checks: <code>Read &amp; write</code> (create check runs)    - Metadata: <code>Read-only</code> (repo info)</p> <p>Organization permissions (optional):    - Members: <code>Read-only</code> (for team-based access)</p> <ol> <li>Subscribe to events:</li> <li>\u2705 Pull request</li> <li>\u2705 Pull request review</li> <li> <p>\u2705 Push (for decision file changes)</p> </li> <li> <p>Where can this GitHub App be installed?</p> </li> <li> <p>Choose Only on this account or Any account</p> </li> <li> <p>Create GitHub App</p> </li> </ol>"},{"location":"implementation/github-app/#step-2-generate-private-key","title":"Step 2: Generate Private Key","text":"<ol> <li>After creation, scroll to Private keys</li> <li>Click Generate a private key</li> <li>Download the <code>.pem</code> file (save securely)</li> </ol>"},{"location":"implementation/github-app/#step-3-install-app","title":"Step 3: Install App","text":"<ol> <li>Go to Install App tab</li> <li>Select your organization/repository</li> <li>Choose All repositories or Select repositories</li> <li>Click Install</li> </ol>"},{"location":"implementation/github-app/#step-4-note-app-details","title":"Step 4: Note App Details","text":"<p>Save these values for server configuration: - App ID (from General tab) - Installation ID (from installation URL) - Webhook secret (you generated earlier) - Private key (the <code>.pem</code> file)</p>"},{"location":"implementation/github-app/#server-implementation","title":"Server Implementation","text":""},{"location":"implementation/github-app/#basic-server-setup","title":"Basic Server Setup","text":"<p>File: <code>server.js</code></p> <pre><code>const express = require('express');\nconst { App } = require('@octokit/app');\nconst { Octokit } = require('@octokit/rest');\nconst crypto = require('crypto');\n\nconst app = express();\nconst port = process.env.PORT || 3000;\n\n// GitHub App configuration\nconst APP_ID = process.env.GITHUB_APP_ID;\nconst PRIVATE_KEY = process.env.GITHUB_PRIVATE_KEY;\nconst WEBHOOK_SECRET = process.env.GITHUB_WEBHOOK_SECRET;\n\n// Initialize Octokit App\nconst githubApp = new App({\n  appId: APP_ID,\n  privateKey: PRIVATE_KEY,\n});\n\n// Middleware\napp.use(express.json());\n\n// Webhook verification middleware\nfunction verifyWebhook(req, res, next) {\n  const signature = req.headers['x-hub-signature-256'];\n  const payload = JSON.stringify(req.body);\n\n  const hmac = crypto.createHmac('sha256', WEBHOOK_SECRET);\n  const digest = 'sha256=' + hmac.update(payload).digest('hex');\n\n  if (signature === digest) {\n    next();\n  } else {\n    res.status(401).send('Invalid signature');\n  }\n}\n\n// Webhook endpoint\napp.post('/webhooks', verifyWebhook, async (req, res) =&gt; {\n  const event = req.headers['x-github-event'];\n  const payload = req.body;\n\n  console.log(`Received ${event} event`);\n\n  try {\n    if (event === 'pull_request') {\n      await handlePullRequest(payload);\n    }\n\n    res.status(200).send('OK');\n  } catch (error) {\n    console.error('Error handling webhook:', error);\n    res.status(500).send('Error');\n  }\n});\n\n// Health check\napp.get('/health', (req, res) =&gt; {\n  res.status(200).json({ status: 'ok' });\n});\n\napp.listen(port, () =&gt; {\n  console.log(`ProvenanceCode server listening on port ${port}`);\n});\n</code></pre>"},{"location":"implementation/github-app/#installation","title":"Installation","text":"<pre><code>npm init -y\nnpm install express @octokit/app @octokit/rest dotenv\n</code></pre>"},{"location":"implementation/github-app/#environment-variables","title":"Environment Variables","text":"<p>Create <code>.env</code>:</p> <pre><code>GITHUB_APP_ID=123456\nGITHUB_PRIVATE_KEY=\"-----BEGIN RSA PRIVATE KEY-----\\n...\\n-----END RSA PRIVATE KEY-----\"\nGITHUB_WEBHOOK_SECRET=your-webhook-secret\nPORT=3000\n</code></pre> <p>Load in server:</p> <pre><code>require('dotenv').config();\n</code></pre>"},{"location":"implementation/github-app/#webhook-handling","title":"Webhook Handling","text":""},{"location":"implementation/github-app/#pull-request-handler","title":"Pull Request Handler","text":"<pre><code>async function handlePullRequest(payload) {\n  const { action, pull_request, repository, installation } = payload;\n\n  // Only process opened, synchronize, reopened\n  if (!['opened', 'synchronize', 'reopened'].includes(action)) {\n    return;\n  }\n\n  console.log(`Processing PR #${pull_request.number} in ${repository.full_name}`);\n\n  // Get installation client\n  const octokit = await githubApp.getInstallationOctokit(installation.id);\n\n  // Fetch decision files from repo\n  const decisions = await fetchDecisions(octokit, repository, pull_request);\n\n  // Run validation\n  const results = await validateProvenanceCode(\n    octokit,\n    repository,\n    pull_request,\n    decisions\n  );\n\n  // Post results\n  await postValidationResults(octokit, repository, pull_request, results);\n\n  // Create status check\n  await createStatusCheck(octokit, repository, pull_request, results);\n}\n</code></pre>"},{"location":"implementation/github-app/#fetch-decision-files","title":"Fetch Decision Files","text":"<pre><code>async function fetchDecisions(octokit, repository, pull_request) {\n  const { owner, repo } = repository;\n  const ref = pull_request.head.ref;\n\n  try {\n    // List decisions directory\n    const { data: contents } = await octokit.rest.repos.getContent({\n      owner: owner.login,\n      repo: repo.name,\n      path: 'provenance/decisions',\n      ref: ref\n    });\n\n    const decisions = [];\n\n    for (const item of contents) {\n      if (item.type === 'dir' &amp;&amp; /^DEC-\\d{6}$/.test(item.name)) {\n        // Fetch decision.json\n        try {\n          const { data: file } = await octokit.rest.repos.getContent({\n            owner: owner.login,\n            repo: repo.name,\n            path: `${item.path}/decision.json`,\n            ref: ref\n          });\n\n          const content = Buffer.from(file.content, 'base64').toString('utf8');\n          const decision = JSON.parse(content);\n\n          decisions.push({\n            id: item.name,\n            path: item.path,\n            data: decision\n          });\n        } catch (err) {\n          console.error(`Failed to fetch ${item.name}/decision.json:`, err.message);\n        }\n      }\n    }\n\n    return decisions;\n  } catch (error) {\n    console.error('Error fetching decisions:', error);\n    return [];\n  }\n}\n</code></pre>"},{"location":"implementation/github-app/#validation-logic","title":"Validation Logic","text":""},{"location":"implementation/github-app/#core-validator","title":"Core Validator","text":"<pre><code>async function validateProvenanceCode(octokit, repository, pull_request, decisions) {\n  const results = {\n    valid: true,\n    errors: [],\n    warnings: [],\n    decisions: {\n      found: decisions.length,\n      required: 0,\n      list: decisions\n    },\n    specs: {\n      found: 0,\n      required: 0,\n      list: []\n    },\n    risks: {\n      found: 0,\n      required: 0,\n      list: []\n    }\n  };\n\n  // Load config\n  const config = await loadConfig(octokit, repository, pull_request);\n\n  // Get changed files\n  const changedFiles = await getChangedFiles(octokit, repository, pull_request);\n\n  // Check if decision required\n  const requiresDecision = checkDecisionRequired(config, changedFiles, pull_request);\n\n  if (requiresDecision) {\n    results.decisions.required = 1;\n\n    if (decisions.length === 0) {\n      results.valid = false;\n      results.errors.push('Decision required but none found');\n    } else {\n      // Validate decision format\n      for (const decision of decisions) {\n        const validation = validateDecisionFormat(decision.data);\n        if (!validation.valid) {\n          results.valid = false;\n          results.errors.push(`${decision.id}: ${validation.error}`);\n        }\n      }\n\n      // Check PR link\n      const hasValidPRLink = decisions.some(dec =&gt; \n        dec.data.links?.pr?.includes(String(pull_request.number)) ||\n        dec.data.links?.pr?.includes(pull_request.html_url)\n      );\n\n      if (!hasValidPRLink) {\n        results.warnings.push('Decision should reference this PR in links.pr');\n      }\n    }\n  }\n\n  // Similar checks for specs and risks...\n\n  return results;\n}\n\nfunction checkDecisionRequired(config, changedFiles, pull_request) {\n  // Check paths\n  for (const file of changedFiles) {\n    for (const path of config.requireDecisionOnPaths || []) {\n      if (file.startsWith(path)) {\n        return true;\n      }\n    }\n  }\n\n  // Check labels\n  const labels = pull_request.labels.map(l =&gt; l.name);\n  for (const label of labels) {\n    if (config.requireDecisionOnLabels?.includes(label)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction validateDecisionFormat(decision) {\n  const required = ['schema', 'id', 'title', 'version', 'lifecycle', 'timestamps', 'actors', 'outcome', 'rationale', 'risk'];\n\n  for (const field of required) {\n    if (!decision[field]) {\n      return { valid: false, error: `Missing required field: ${field}` };\n    }\n  }\n\n  // Validate ID format\n  if (!/^DEC-\\d{6}$/.test(decision.id)) {\n    return { valid: false, error: 'Invalid ID format (must be DEC-XXXXXX)' };\n  }\n\n  return { valid: true };\n}\n</code></pre>"},{"location":"implementation/github-app/#get-changed-files","title":"Get Changed Files","text":"<pre><code>async function getChangedFiles(octokit, repository, pull_request) {\n  const { owner, repo } = repository;\n\n  const { data: files } = await octokit.rest.pulls.listFiles({\n    owner: owner.login,\n    repo: repo.name,\n    pull_number: pull_request.number\n  });\n\n  return files.map(f =&gt; f.filename);\n}\n</code></pre>"},{"location":"implementation/github-app/#post-results","title":"Post Results","text":""},{"location":"implementation/github-app/#pr-comment","title":"PR Comment","text":"<pre><code>async function postValidationResults(octokit, repository, pull_request, results) {\n  const { owner, repo } = repository;\n\n  let body = '## ProvenanceCode Validation Results\\n\\n';\n\n  if (results.valid) {\n    body += '\u2705 **All checks passed**\\n\\n';\n  } else {\n    body += '\u274c **Validation failed**\\n\\n';\n  }\n\n  body += '### Summary\\n\\n';\n  body += `- **Decisions:** ${results.decisions.found}/${results.decisions.required}\\n`;\n  body += `- **Specs:** ${results.specs.found}/${results.specs.required}\\n`;\n  body += `- **Risks:** ${results.risks.found}/${results.risks.required}\\n\\n`;\n\n  if (results.decisions.list.length &gt; 0) {\n    body += '### Decisions Found\\n\\n';\n    results.decisions.list.forEach(dec =&gt; {\n      body += `- [${dec.id}](https://github.com/${owner.login}/${repo.name}/blob/${pull_request.head.ref}/${dec.path}/decision.json) - ${dec.data.title}\\n`;\n    });\n    body += '\\n';\n  }\n\n  if (results.errors.length &gt; 0) {\n    body += '### Errors\\n\\n';\n    results.errors.forEach(err =&gt; body += `- \u274c ${err}\\n`);\n    body += '\\n';\n  }\n\n  if (results.warnings.length &gt; 0) {\n    body += '### Warnings\\n\\n';\n    results.warnings.forEach(warn =&gt; body += `- \u26a0\ufe0f ${warn}\\n`);\n    body += '\\n';\n  }\n\n  body += '---\\n';\n  body += '*Validated by [ProvenanceCode](https://provenancecode.org)*';\n\n  // Find or create comment\n  const { data: comments } = await octokit.rest.issues.listComments({\n    owner: owner.login,\n    repo: repo.name,\n    issue_number: pull_request.number\n  });\n\n  const existingComment = comments.find(c =&gt; \n    c.user.type === 'Bot' &amp;&amp; \n    c.body.includes('ProvenanceCode Validation Results')\n  );\n\n  if (existingComment) {\n    await octokit.rest.issues.updateComment({\n      owner: owner.login,\n      repo: repo.name,\n      comment_id: existingComment.id,\n      body\n    });\n  } else {\n    await octokit.rest.issues.createComment({\n      owner: owner.login,\n      repo: repo.name,\n      issue_number: pull_request.number,\n      body\n    });\n  }\n}\n</code></pre>"},{"location":"implementation/github-app/#status-check","title":"Status Check","text":"<pre><code>async function createStatusCheck(octokit, repository, pull_request, results) {\n  const { owner, repo } = repository;\n\n  await octokit.rest.repos.createCommitStatus({\n    owner: owner.login,\n    repo: repo.name,\n    sha: pull_request.head.sha,\n    state: results.valid ? 'success' : 'failure',\n    context: 'ProvenanceCode',\n    description: results.valid ? 'All checks passed' : 'Validation failed',\n    target_url: 'https://your-domain.com/results'\n  });\n}\n</code></pre>"},{"location":"implementation/github-app/#ui-integration","title":"UI Integration","text":""},{"location":"implementation/github-app/#decision-viewer-optional","title":"Decision Viewer (Optional)","text":"<p>Provide a web UI to browse decisions:</p> <pre><code>app.get('/decisions/:owner/:repo', async (req, res) =&gt; {\n  const { owner, repo } = req.params;\n\n  // Fetch decisions from GitHub\n  const decisions = await fetchAllDecisions(owner, repo);\n\n  res.render('decisions', { decisions, owner, repo });\n});\n</code></pre>"},{"location":"implementation/github-app/#oauth-authentication","title":"OAuth Authentication","text":"<p>For secure access:</p> <pre><code>const { createOAuthAppAuth } = require('@octokit/auth-oauth-app');\n\napp.get('/auth/login', (req, res) =&gt; {\n  const url = `https://github.com/login/oauth/authorize?client_id=${CLIENT_ID}&amp;redirect_uri=${CALLBACK_URL}`;\n  res.redirect(url);\n});\n\napp.get('/auth/callback', async (req, res) =&gt; {\n  const { code } = req.query;\n\n  // Exchange code for token\n  const auth = createOAuthAppAuth({\n    clientId: CLIENT_ID,\n    clientSecret: CLIENT_SECRET\n  });\n\n  const { token } = await auth({\n    type: 'oauth-user',\n    code\n  });\n\n  // Store token in session\n  req.session.token = token;\n  res.redirect('/dashboard');\n});\n</code></pre>"},{"location":"implementation/github-app/#access-control","title":"Access Control","text":""},{"location":"implementation/github-app/#team-based-permissions","title":"Team-Based Permissions","text":"<pre><code>async function checkAccess(octokit, user, repository, action) {\n  const config = await loadConfig(octokit, repository);\n\n  if (action === 'edit') {\n    // Check if user is in editorTeams\n    for (const team of config.access.editorTeams) {\n      const isMember = await checkTeamMembership(octokit, user, team);\n      if (isMember) return true;\n    }\n  }\n\n  if (action === 'view') {\n    // Check if user is in viewerTeams\n    for (const team of config.access.viewerTeams) {\n      const isMember = await checkTeamMembership(octokit, user, team);\n      if (isMember) return true;\n    }\n  }\n\n  return false;\n}\n</code></pre>"},{"location":"implementation/github-app/#deployment","title":"Deployment","text":""},{"location":"implementation/github-app/#option-1-heroku","title":"Option 1: Heroku","text":"<pre><code>heroku create provenance code-validator\nheroku config:set GITHUB_APP_ID=123456\nheroku config:set GITHUB_PRIVATE_KEY=\"$(cat private-key.pem)\"\nheroku config:set GITHUB_WEBHOOK_SECRET=your-secret\ngit push heroku main\n</code></pre>"},{"location":"implementation/github-app/#option-2-docker","title":"Option 2: Docker","text":"<p>Dockerfile:</p> <pre><code>FROM node:18-alpine\nWORKDIR /app\nCOPY package*.json ./\nRUN npm install --production\nCOPY . .\nEXPOSE 3000\nCMD [\"node\", \"server.js\"]\n</code></pre> <p>Deploy:</p> <pre><code>docker build -t provenancecode-validator .\ndocker run -p 3000:3000 --env-file .env provenancecode-validator\n</code></pre>"},{"location":"implementation/github-app/#option-3-cloud-run-gcp","title":"Option 3: Cloud Run (GCP)","text":"<pre><code>gcloud run deploy provenancecode-validator \\\n  --source . \\\n  --platform managed \\\n  --region us-central1 \\\n  --allow-unauthenticated\n</code></pre>"},{"location":"implementation/github-app/#advanced-features","title":"Advanced Features","text":""},{"location":"implementation/github-app/#auto-create-decision-drafts","title":"Auto-Create Decision Drafts","text":"<p>When validation fails, automatically create a draft:</p> <pre><code>async function createDecisionDraft(octokit, repository, pull_request) {\n  const nextId = await getNextDecisionId(octokit, repository);\n\n  const draft = {\n    schema: 'provenancecode.decision.v1',\n    id: nextId,\n    title: pull_request.title,\n    version: 1,\n    lifecycle: { state: 'draft' },\n    timestamps: { created_at: new Date().toISOString() },\n    actors: { author: pull_request.user.login },\n    outcome: 'TODO: Document decision',\n    rationale: 'TODO: Explain rationale',\n    risk: { level: 'low' },\n    links: { pr: [String(pull_request.number)] }\n  };\n\n  // Create PR with draft\n  await octokit.rest.pulls.create({\n    owner: repository.owner.login,\n    repo: repository.name,\n    title: `Add decision draft ${nextId}`,\n    head: `decision-draft-${nextId}`,\n    base: repository.default_branch,\n    body: `Auto-generated decision draft for PR #${pull_request.number}`\n  });\n}\n</code></pre>"},{"location":"implementation/github-app/#next-steps","title":"Next Steps","text":"<ol> <li>Set up GitHub App following the setup section</li> <li>Deploy server to your hosting environment</li> <li>Install app on your repositories</li> <li>Test with PR that requires decisions</li> <li>Monitor logs and iterate</li> </ol>"},{"location":"implementation/github-app/#related-documentation","title":"Related Documentation","text":"<ul> <li>GitHub Actions Implementation - Simpler alternative</li> <li>Enforcement Policies - Configure validation</li> <li>Getting Started - Initial setup</li> </ul> <p>References: - GitHub Apps Documentation - Octokit.js - Probot Framework - Alternative app framework</p>"},{"location":"standard/","title":"ProvenanceCode Open Standard Specification","text":"<p>Version: 1.0.0 Status: Draft Last Updated: February 2026</p>"},{"location":"standard/#abstract","title":"Abstract","text":"<p>ProvenanceCode is an open standard for creating auditable trails of technical decisions, risk acceptances, mistake records, and specifications in software development projects. This standard defines file formats, directory structures, enforcement policies, and integration patterns that enable teams to maintain institutional knowledge and governance without heavy process overhead.</p>"},{"location":"standard/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Introduction</li> <li>Core Principles</li> <li>Scope</li> <li>Specification Documents</li> <li>Conformance Levels</li> <li>Terminology</li> <li>References</li> </ol>"},{"location":"standard/#introduction","title":"Introduction","text":""},{"location":"standard/#problem-statement","title":"Problem Statement","text":"<p>Software projects accumulate technical decisions, accepted risks, and learned mistakes, but this knowledge is often: - Scattered across PR comments, Slack messages, and tribal knowledge - Lost when team members leave - Inaccessible to new team members and AI assistants - Unauditable for compliance purposes - Difficult to link between requirements, decisions, and implementation</p>"},{"location":"standard/#solution","title":"Solution","text":"<p>ProvenanceCode provides a structured, version-controlled format for capturing: - Decision Evidence Objects (DEOs) - Why technical choices were made - Risk Acceptances - Formal acknowledgment of known risks with mitigation plans - Mistake Records - Post-mortems that create prevention rules - Specifications - Requirements linked to implementing decisions</p>"},{"location":"standard/#core-principles","title":"Core Principles","text":""},{"location":"standard/#1-git-native","title":"1. Git-Native","text":"<p>All provenance artifacts live in the same repository as the code they describe, versioned together.</p>"},{"location":"standard/#2-human-and-machine-readable","title":"2. Human and Machine Readable","text":"<p>JSON for structured data, Markdown for human narrative. Both are first-class citizens.</p>"},{"location":"standard/#3-non-invasive","title":"3. Non-Invasive","text":"<p>Adoption is incremental. Start with decisions only, add specs and risks as needed.</p>"},{"location":"standard/#4-ai-friendly","title":"4. AI-Friendly","text":"<p>Clear rules guide AI assistants to create drafts before implementing changes, but humans always approve.</p>"},{"location":"standard/#5-enforcement-flexibility","title":"5. Enforcement Flexibility","text":"<p>Three presets (Light, Standard, Regulated) allow teams to choose appropriate governance levels.</p>"},{"location":"standard/#6-auditable","title":"6. Auditable","text":"<p>Timestamps, actors, and optional cryptographic receipts create tamper-evident trails.</p>"},{"location":"standard/#scope","title":"Scope","text":""},{"location":"standard/#in-scope","title":"In Scope","text":"<ul> <li>File formats for decisions, risks, mistakes, and specs</li> <li>Directory structure conventions</li> <li>Enforcement policy configuration</li> <li>Lifecycle state management</li> <li>Linking and traceability patterns</li> <li>AI assistant integration guidelines</li> </ul>"},{"location":"standard/#out-of-scope","title":"Out of Scope","text":"<ul> <li>Specific CI/CD implementation details (examples provided)</li> <li>Git hosting platform requirements (works with GitHub, GitLab, Bitbucket)</li> <li>Programming language or framework restrictions</li> <li>Team size or organizational structure</li> <li>Cryptographic signature implementations (optional extensions)</li> </ul>"},{"location":"standard/#specification-documents","title":"Specification Documents","text":"<p>This standard consists of the following normative documents:</p>"},{"location":"standard/#core-specifications","title":"Core Specifications","text":"<ol> <li>Repository Layout - Directory structure and file organization</li> <li>Decision Evidence Objects (DEO) - Decision record format and lifecycle</li> <li>Enforcement Policies - Validation rules and presets</li> <li>Versioning and Lifecycle - State management and supersession</li> </ol>"},{"location":"standard/#extended-specifications","title":"Extended Specifications","text":"<ol> <li>Risk Acceptance Format - Risk record structure (see schemas)</li> <li>Mistake Record Format - Post-mortem and prevention rules (see schemas)</li> <li>Specification Format - Requirements and acceptance criteria (see schemas)</li> <li>Indexes and Linking - Cross-reference patterns (see schemas)</li> </ol>"},{"location":"standard/#non-normative-documents","title":"Non-Normative Documents","text":"<ul> <li>Implementation guides (in <code>/guides/</code>)</li> <li>Examples (in <code>/examples/</code>)</li> <li>Integration patterns</li> <li>Best practices</li> </ul>"},{"location":"standard/#conformance-levels","title":"Conformance Levels","text":""},{"location":"standard/#level-1-decision-records-only","title":"Level 1: Decision Records Only","text":"<p>Requirements: - Directory structure: <code>/provenance/decisions/</code> - Config file: <code>provenance/config.json</code> - At least one decision record in valid format - Decision IDs follow format: <code>DEC-XXXXXX</code> (6 digits)</p> <p>Suitable for: Teams starting with lightweight decision tracking</p>"},{"location":"standard/#level-2-standard-compliance","title":"Level 2: Standard Compliance","text":"<p>Requirements: - All Level 1 requirements - Enforcement policy: <code>provenance/policies/enforcement.yml</code> - Support for risks and specs (directories created) - PR template integration - Decision lifecycle management (draft \u2192 accepted \u2192 superseded)</p> <p>Suitable for: Production teams requiring governance</p>"},{"location":"standard/#level-3-full-provenance","title":"Level 3: Full Provenance","text":"<p>Requirements: - All Level 2 requirements - Mistake records with prevention rules - Acceptance receipts with cryptographic verification - Learnings indexes - Cross-linking between decisions, risks, specs, and mistakes - AI assistant rules: <code>.provenancecode/ai-rules.md</code></p> <p>Suitable for: Regulated industries, safety-critical systems</p>"},{"location":"standard/#terminology","title":"Terminology","text":"<p>MUST, MUST NOT, REQUIRED, SHALL, SHALL NOT, SHOULD, SHOULD NOT, RECOMMENDED, MAY, and OPTIONAL in this document are to be interpreted as described in RFC 2119.</p>"},{"location":"standard/#key-terms","title":"Key Terms","text":"<ul> <li>Decision Evidence Object (DEO) - A structured record of a technical decision including context, options, outcome, and rationale</li> <li>Decision ID - Unique identifier following format <code>DEC-XXXXXX</code> where X is a digit</li> <li>Risk Acceptance (RA) - Formal acknowledgment of a known risk with severity, mitigations, and expiration</li> <li>Mistake Record (MR) - Post-mortem documenting an error, root cause, and prevention rule</li> <li>Specification (SPEC) - Requirements document with acceptance criteria</li> <li>Lifecycle State - Current status of a record (draft, proposed, accepted, rejected, superseded)</li> <li>Enforcement Preset - Pre-configured policy level (light, standard, regulated)</li> <li>Provenance Path - Root directory containing all provenance artifacts (<code>/provenance/</code>)</li> <li>Acceptance Receipt - Cryptographic proof of decision approval (optional)</li> <li>Guardrail - Prevention rule derived from a mistake record</li> </ul>"},{"location":"standard/#references","title":"References","text":""},{"location":"standard/#normative-references","title":"Normative References","text":"<ul> <li>RFC 2119: Key words for use in RFCs to Indicate Requirement Levels</li> <li>JSON Schema Draft 2020-12</li> <li>YAML 1.2.2</li> <li>ISO 8601: Date and time format</li> <li>Semantic Versioning 2.0.0</li> </ul>"},{"location":"standard/#informative-references","title":"Informative References","text":"<ul> <li>Architecture Decision Records (ADR) by Michael Nygard</li> <li>C2PA Content Credentials (optional extension)</li> <li>W3C PROV Data Model (optional extension)</li> <li>Git commit conventions (Conventional Commits)</li> </ul>"},{"location":"standard/#version-history","title":"Version History","text":"Version Date Changes 1.0.0 2026-02-12 Initial draft specification"},{"location":"standard/#contributing","title":"Contributing","text":"<p>ProvenanceCode is an open standard. We welcome:</p> <ul> <li>Specification improvements - Suggest changes via GitHub Issues</li> <li>Implementation feedback - Share what works and what doesn't</li> <li>New implementations - Build tools, plugins, and services</li> <li>Documentation - Help clarify and expand the standard</li> </ul> <p>All contributions to the specification are reviewed by the core team with community input.</p>"},{"location":"standard/#how-to-contribute","title":"How to Contribute","text":"<ol> <li>Discuss: Open an issue describing your proposal</li> <li>Draft: Fork the repo and make changes</li> <li>Submit: Create a pull request with clear rationale</li> <li>Collaborate: Iterate based on feedback</li> <li>Adopt: Once accepted, changes are incorporated</li> </ol>"},{"location":"standard/#license-intellectual-property","title":"License &amp; Intellectual Property","text":""},{"location":"standard/#standard-specification","title":"Standard Specification","text":"<p>The ProvenanceCode specification (this documentation) is licensed under Apache License 2.0.</p> <p>This means you can: - \u2705 Use it commercially - \u2705 Modify it for your needs - \u2705 Distribute it - \u2705 Use it privately - \u2705 Use patent claims in the specification</p>"},{"location":"standard/#why-apache-20","title":"Why Apache 2.0?","text":"<p>Apache 2.0 provides: - Maximum permissiveness for adoption - Patent protection for implementers - Commercial-friendly licensing - Clear liability limitations - Industry standard recognition</p>"},{"location":"standard/#implementation-freedom","title":"Implementation Freedom","text":"<p>You are free to build commercial or open-source implementations without restriction. The standard itself remains open; implementations can be any license.</p>"},{"location":"standard/#governance","title":"Governance","text":""},{"location":"standard/#stewardship","title":"Stewardship","text":"<p>ProvenanceCode is currently stewarded by EmbankAI as the initial developer and maintainer.</p>"},{"location":"standard/#decision-process","title":"Decision Process","text":"<ul> <li>Specification changes require consensus from core maintainers</li> <li>Breaking changes trigger new major version</li> <li>Community input is considered for all changes</li> <li>Transparency - all decisions documented in this repository</li> </ul>"},{"location":"standard/#future-governance","title":"Future Governance","text":"<p>As the standard matures, we may transition to a foundation model or community governance structure to ensure long-term independence and neutrality.</p> <p>Next: Read the Repository Layout specification to understand the required directory structure.</p>"},{"location":"standard/deo/","title":"Decision Evidence Objects (DEO) Specification","text":"<p>Version: 1.0.0 Status: Draft Part of: ProvenanceCode Open Standard</p>"},{"location":"standard/deo/#abstract","title":"Abstract","text":"<p>This document defines the Decision Evidence Object (DEO) format, a structured way to capture technical decisions in software projects. DEOs provide auditable evidence of why decisions were made, what options were considered, and what risks were accepted.</p>"},{"location":"standard/deo/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>File Structure</li> <li>Decision ID Format</li> <li>JSON Schema</li> <li>Markdown Format</li> <li>Lifecycle States</li> <li>Required Fields</li> <li>Optional Extensions</li> <li>Examples</li> <li>Validation Rules</li> </ol>"},{"location":"standard/deo/#overview","title":"Overview","text":"<p>A Decision Evidence Object (DEO) is a structured record that captures: - Context: Why the decision was needed - Options: Alternatives that were considered - Outcome: What was chosen - Rationale: Why this option was selected - Risk: Associated risks and their acceptance - Links: Connections to specs, PRs, issues, and other decisions</p>"},{"location":"standard/deo/#file-structure","title":"File Structure","text":"<p>Each decision MUST be stored in its own directory:</p> <pre><code>/provenance/decisions/DEC-XXXXXX/\n  decision.json          (REQUIRED - source of truth)\n  decision.md            (RECOMMENDED - human narrative)\n  acceptance.receipt.json (OPTIONAL - cryptographic proof)\n  prov.jsonld            (OPTIONAL - W3C PROV format)\n  c2pa.manifest.json     (OPTIONAL - C2PA credentials)\n  /evidence/             (OPTIONAL - supporting artifacts)\n</code></pre>"},{"location":"standard/deo/#file-purposes","title":"File Purposes","text":"<ul> <li>decision.json - Structured data, machine-readable, validates against schema</li> <li>decision.md - Human-friendly narrative, context, and discussion</li> <li>acceptance.receipt.json - Cryptographic proof of approval (timestamps, signatures)</li> <li>prov.jsonld - W3C PROV format for provenance chains</li> <li>c2pa.manifest.json - Content Credentials for tamper detection</li> <li>/evidence/ - Screenshots, diagrams, logs, or other supporting files</li> </ul>"},{"location":"standard/deo/#decision-id-format","title":"Decision ID Format","text":"<p>Decision IDs MUST follow this format:</p> <pre><code>DEC-XXXXXX\n</code></pre> <p>Where: - <code>DEC-</code> is the required prefix - <code>XXXXXX</code> is a 6-digit zero-padded number (000001 through 999999)</p> <p>Examples: - \u2705 <code>DEC-000001</code> - \u2705 <code>DEC-042815</code> - \u274c <code>DEC-1</code> (must be zero-padded) - \u274c <code>DECISION-000001</code> (wrong prefix) - \u274c <code>DEC-0000001</code> (too many digits)</p>"},{"location":"standard/deo/#id-assignment","title":"ID Assignment","text":"<p>Decision IDs SHOULD be assigned sequentially. The folder name MUST match the <code>id</code> field in <code>decision.json</code>.</p> <pre><code>/provenance/decisions/DEC-000042/decision.json\n</code></pre> <p>Contains:</p> <pre><code>{\n  \"id\": \"DEC-000042\",\n  ...\n}\n</code></pre>"},{"location":"standard/deo/#json-schema","title":"JSON Schema","text":""},{"location":"standard/deo/#minimal-required-decision","title":"Minimal Required Decision","text":"<pre><code>{\n  \"schema\": \"provenancecode.decision.v1\",\n  \"id\": \"DEC-000001\",\n  \"title\": \"Brief decision title\",\n  \"version\": 1,\n  \"lifecycle\": {\n    \"state\": \"accepted\"\n  },\n  \"timestamps\": {\n    \"created_at\": \"2026-02-12T10:30:00Z\"\n  },\n  \"actors\": {\n    \"author\": \"username\"\n  },\n  \"outcome\": \"What was decided\",\n  \"rationale\": \"Why this was chosen\",\n  \"risk\": {\n    \"level\": \"low\"\n  }\n}\n</code></pre>"},{"location":"standard/deo/#complete-decision-schema","title":"Complete Decision Schema","text":"<pre><code>{\n  \"schema\": \"provenancecode.decision.v1\",\n  \"id\": \"DEC-000042\",\n  \"title\": \"Migrate from REST to GraphQL for API layer\",\n  \"version\": 1,\n\n  \"lifecycle\": {\n    \"state\": \"accepted\",\n    \"supersedes\": null,\n    \"superseded_by\": null\n  },\n\n  \"timestamps\": {\n    \"created_at\": \"2026-02-10T14:30:00Z\",\n    \"accepted_at\": \"2026-02-12T09:15:00Z\",\n    \"updated_at\": null,\n    \"expires_at\": null\n  },\n\n  \"actors\": {\n    \"author\": \"user:alice\",\n    \"approver\": \"user:bob\",\n    \"bot\": \"cursor-ai\",\n    \"reviewers\": [\"user:carol\", \"user:dave\"]\n  },\n\n  \"context\": {\n    \"jira_key\": \"ARCH-425\",\n    \"repo\": \"backend-api\",\n    \"component\": \"api-layer\",\n    \"links\": [\n      \"https://company.atlassian.net/browse/ARCH-425\",\n      \"https://github.com/org/repo/pull/142\"\n    ]\n  },\n\n  \"problem\": \"REST API has grown complex with multiple endpoints, inconsistent patterns, and overfetching issues affecting mobile clients.\",\n\n  \"options\": [\n    \"Continue with REST and refactor endpoints\",\n    \"Migrate to GraphQL with gradual rollout\",\n    \"Adopt gRPC for internal services\"\n  ],\n\n  \"outcome\": \"Migrate to GraphQL with gradual rollout starting with mobile endpoints.\",\n\n  \"rationale\": \"GraphQL provides better mobile experience, type safety, and eliminates overfetching. Gradual rollout minimizes risk.\",\n\n  \"risk\": {\n    \"level\": \"medium\",\n    \"description\": \"Learning curve and potential performance issues with complex queries\",\n    \"acceptance\": \"RA-000015\",\n    \"mitigations\": [\n      \"Team training on GraphQL best practices\",\n      \"Query complexity limits enforced\",\n      \"Performance monitoring dashboard\"\n    ]\n  },\n\n  \"scope\": [\n    \"api\",\n    \"mobile\",\n    \"architecture\"\n  ],\n\n  \"tags\": [\n    \"graphql\",\n    \"rest\",\n    \"migration\",\n    \"architecture\"\n  ],\n\n  \"links\": {\n    \"pr\": [\"142\"],\n    \"issues\": [\"https://github.com/org/repo/issues/98\"],\n    \"specs\": [\"SPEC-000028\"],\n    \"decisions\": [\"DEC-000015\"],\n    \"risks\": [\"RA-000015\"]\n  },\n\n  \"integrity\": {\n    \"receipt_path\": \"provenance/decisions/DEC-000042/acceptance.receipt.json\",\n    \"commit_sha\": \"a1b2c3d4e5f6\",\n    \"prov_path\": \"provenance/decisions/DEC-000042/prov.jsonld\"\n  },\n\n  \"attestations\": [\n    {\n      \"type\": \"c2pa\",\n      \"manifest_path\": \"provenance/decisions/DEC-000042/c2pa.manifest.json\"\n    }\n  ],\n\n  \"metadata\": {\n    \"review_duration_hours\": 48,\n    \"stakeholder_count\": 4,\n    \"impact_score\": 8\n  }\n}\n</code></pre>"},{"location":"standard/deo/#field-definitions","title":"Field Definitions","text":""},{"location":"standard/deo/#required-fields","title":"Required Fields","text":"Field Type Description <code>schema</code> string MUST be <code>\"provenancecode.decision.v1\"</code> <code>id</code> string Decision ID in format <code>DEC-XXXXXX</code> <code>title</code> string Brief, descriptive title (max 120 chars recommended) <code>version</code> integer Version number (starts at 1, increments on updates) <code>lifecycle.state</code> string Current state: <code>draft</code>, <code>proposed</code>, <code>accepted</code>, <code>rejected</code>, <code>superseded</code> <code>timestamps.created_at</code> string ISO 8601 timestamp of creation <code>actors.author</code> string Username or identifier of decision author <code>outcome</code> string What was decided <code>rationale</code> string Why this outcome was chosen <code>risk.level</code> string Risk level: <code>low</code>, <code>medium</code>, <code>high</code>, <code>critical</code>"},{"location":"standard/deo/#recommended-fields","title":"Recommended Fields","text":"Field Type Description <code>decision.md</code> file Human-readable narrative <code>timestamps.accepted_at</code> string When decision was approved <code>actors.approver</code> string Who approved the decision <code>options</code> array List of alternatives considered <code>problem</code> string Context and motivation <code>links.pr</code> array Pull request numbers or URLs <code>scope</code> array Affected areas: <code>security</code>, <code>architecture</code>, <code>data</code>, etc. <code>tags</code> array Searchable keywords"},{"location":"standard/deo/#optional-fields","title":"Optional Fields","text":"Field Type Description <code>lifecycle.supersedes</code> string Previous decision ID this replaces <code>lifecycle.superseded_by</code> string New decision ID that replaces this <code>timestamps.updated_at</code> string Last update timestamp <code>timestamps.expires_at</code> string Expiration for temporary decisions <code>actors.bot</code> string AI assistant that created draft <code>actors.reviewers</code> array List of reviewers <code>context.*</code> object External system links (Jira, Linear, etc.) <code>links.specs</code> array Related specification IDs <code>links.decisions</code> array Related decision IDs <code>links.risks</code> array Related risk acceptance IDs <code>risk.acceptance</code> string Risk acceptance ID (RA-XXXXXX) <code>risk.mitigations</code> array Risk mitigation strategies <code>integrity.*</code> object Cryptographic proof references <code>attestations</code> array External attestation formats <code>metadata</code> object Custom project-specific fields"},{"location":"standard/deo/#markdown-format","title":"Markdown Format","text":"<p>The <code>decision.md</code> file provides human context. It SHOULD follow this structure:</p> <pre><code># DEC-XXXXXX: [Title]\n\n**Status:** [State]  \n**Date:** [YYYY-MM-DD]  \n**Author:** [Name]  \n**Approver:** [Name]\n\n## Context\n\n[Why was this decision needed? What problem are we solving?]\n\n## Options Considered\n\n1. **Option A** - [Description and tradeoffs]\n2. **Option B** - [Description and tradeoffs]\n3. **Option C** - [Description and tradeoffs]\n\n## Decision\n\n[What did we decide to do?]\n\n## Rationale\n\n[Why did we choose this option? What makes it better than alternatives?]\n\n## Consequences\n\n### Positive\n- [Benefit 1]\n- [Benefit 2]\n\n### Negative\n- [Tradeoff 1]\n- [Tradeoff 2]\n\n## Risk\n\n**Level:** [low/medium/high/critical]\n\n[Risk description and mitigation plan]\n\n## Implementation\n\n[How will this be implemented? Any phasing or milestones?]\n\n## References\n\n- [SPEC-XXXXXX: Related Specification](../specs/SPEC-XXXXXX/spec.md)\n- [PR #123](https://github.com/org/repo/pull/123)\n- [Original Discussion](https://company.slack.com/archives/C123/p123456)\n</code></pre>"},{"location":"standard/deo/#lifecycle-states","title":"Lifecycle States","text":""},{"location":"standard/deo/#state-definitions","title":"State Definitions","text":"State Description Transitions To <code>draft</code> Initial creation, not yet reviewed <code>proposed</code>, <code>rejected</code> <code>proposed</code> Submitted for review <code>accepted</code>, <code>rejected</code>, <code>draft</code> <code>accepted</code> Approved and active <code>superseded</code> <code>rejected</code> Not approved, will not be implemented none (terminal) <code>superseded</code> Replaced by a newer decision none (terminal)"},{"location":"standard/deo/#state-transition-rules","title":"State Transition Rules","text":"<ol> <li>New decisions MUST start in <code>draft</code> state</li> <li>Decisions can move from <code>draft</code> to <code>proposed</code> when ready for review</li> <li>Only <code>proposed</code> decisions can become <code>accepted</code></li> <li><code>accepted</code> decisions MUST NOT be edited; create new decision and mark old as <code>superseded</code></li> <li><code>rejected</code> and <code>superseded</code> are terminal states</li> </ol>"},{"location":"standard/deo/#supersession","title":"Supersession","text":"<p>When superseding a decision:</p> <pre><code>// Old decision DEC-000010\n{\n  \"id\": \"DEC-000010\",\n  \"lifecycle\": {\n    \"state\": \"superseded\",\n    \"superseded_by\": \"DEC-000042\"\n  }\n}\n\n// New decision DEC-000042\n{\n  \"id\": \"DEC-000042\",\n  \"lifecycle\": {\n    \"state\": \"accepted\",\n    \"supersedes\": \"DEC-000010\"\n  }\n}\n</code></pre>"},{"location":"standard/deo/#optional-extensions","title":"Optional Extensions","text":""},{"location":"standard/deo/#acceptance-receipts","title":"Acceptance Receipts","text":"<p>File: <code>acceptance.receipt.json</code></p> <p>Provides cryptographic proof of approval:</p> <pre><code>{\n  \"schema\": \"provenancecode.receipt.v1\",\n  \"decision_id\": \"DEC-000042\",\n  \"approved_by\": \"user:bob\",\n  \"approved_at\": \"2026-02-12T09:15:00Z\",\n  \"commit_sha\": \"a1b2c3d4e5f6\",\n  \"signature\": \"base64-encoded-signature\",\n  \"certificate\": \"base64-encoded-cert\"\n}\n</code></pre>"},{"location":"standard/deo/#w3c-prov-format","title":"W3C PROV Format","text":"<p>File: <code>prov.jsonld</code></p> <p>Provides provenance chain in W3C standard format for interoperability.</p>"},{"location":"standard/deo/#c2pa-content-credentials","title":"C2PA Content Credentials","text":"<p>File: <code>c2pa.manifest.json</code></p> <p>Tamper-evident credentials following C2PA standard.</p>"},{"location":"standard/deo/#validation-rules","title":"Validation Rules","text":""},{"location":"standard/deo/#structural-validation","title":"Structural Validation","text":"<ol> <li>Decision folder name MUST match <code>id</code> field</li> <li><code>decision.json</code> MUST exist and be valid JSON</li> <li><code>decision.json</code> MUST validate against schema</li> <li><code>schema</code> field MUST be <code>\"provenancecode.decision.v1\"</code></li> <li>All required fields MUST be present</li> </ol>"},{"location":"standard/deo/#semantic-validation","title":"Semantic Validation","text":"<ol> <li><code>id</code> MUST match format <code>DEC-XXXXXX</code> with 6 digits</li> <li><code>lifecycle.state</code> MUST be valid state name</li> <li><code>timestamps.created_at</code> MUST be valid ISO 8601</li> <li><code>risk.level</code> MUST be <code>low</code>, <code>medium</code>, <code>high</code>, or <code>critical</code></li> <li>If <code>lifecycle.supersedes</code> is present, that decision MUST exist</li> <li>If <code>links.specs</code> is present, referenced specs SHOULD exist</li> <li>If <code>links.pr</code> is present and enforcement requires it, PR MUST match current PR</li> </ol>"},{"location":"standard/deo/#link-validation","title":"Link Validation","text":"<ol> <li><code>links.pr</code> entries MUST be valid PR numbers or URLs</li> <li><code>links.decisions</code> entries MUST reference existing decisions</li> <li><code>links.risks</code> entries MUST reference existing risk acceptances</li> <li><code>links.specs</code> entries MUST reference existing specifications</li> </ol>"},{"location":"standard/deo/#examples","title":"Examples","text":"<p>See <code>/examples/example-decision/</code> for complete working examples including: - Minimal decision - Architectural decision with multiple options - Security decision with risk acceptance - Decision with cryptographic receipt</p>"},{"location":"standard/deo/#non-normative-guidance","title":"Non-Normative Guidance","text":""},{"location":"standard/deo/#when-to-create-a-decision","title":"When to Create a Decision","text":"<p>Create a decision record when: - Making architectural or cross-cutting changes - Accepting technical debt or risks - Choosing between significant alternatives - Making security or compliance-related choices - Establishing patterns or conventions - Making irreversible changes (migrations, API contracts)</p>"},{"location":"standard/deo/#when-not-to-create-a-decision","title":"When NOT to Create a Decision","text":"<p>Skip decision records for: - Routine bug fixes - Documentation updates - Code formatting or style changes - Dependency version bumps (unless breaking) - Test additions</p>"},{"location":"standard/deo/#best-practices","title":"Best Practices","text":"<ol> <li>Write drafts early - Create draft while evaluating options</li> <li>Be concise - Keep outcome and rationale focused</li> <li>List alternatives - Show what was considered</li> <li>Link everything - Connect to PRs, specs, and related decisions</li> <li>Update state - Mark as accepted when merged</li> <li>Never edit accepted - Supersede instead of modifying</li> </ol> <p>Next: Enforcement Policies - Learn how decisions are validated</p>"},{"location":"standard/enforcement/","title":"Enforcement Policies Specification","text":"<p>Version: 1.0.0 Status: Draft Part of: ProvenanceCode Open Standard</p>"},{"location":"standard/enforcement/#abstract","title":"Abstract","text":"<p>This document defines how ProvenanceCode validates decision evidence, specifications, and risk acceptances through configurable enforcement policies. Three presets (Light, Standard, Regulated) provide flexibility for different team needs.</p>"},{"location":"standard/enforcement/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Enforcement Philosophy</li> <li>Configuration Files</li> <li>Enforcement Presets</li> <li>Validation Rules</li> <li>Path and Label Triggers</li> <li>Blocking Modes</li> <li>Drift Detection</li> <li>AI Attribution</li> <li>Examples</li> </ol>"},{"location":"standard/enforcement/#overview","title":"Overview","text":"<p>Enforcement policies determine: - When validation occurs (which paths, labels trigger requirements) - What is required (decisions, specs, risks, or mistake references) - How strictly rules are applied (warn, block selectively, or block always) - What state artifacts must be in (draft, review, accepted)</p>"},{"location":"standard/enforcement/#enforcement-philosophy","title":"Enforcement Philosophy","text":""},{"location":"standard/enforcement/#three-principles","title":"Three Principles","text":"<ol> <li>Flexibility - Teams choose their governance level</li> <li>Progressive Adoption - Start light, increase rigor as needed</li> <li>Context-Aware - Different rules for different paths and change types</li> </ol>"},{"location":"standard/enforcement/#when-enforcement-runs","title":"When Enforcement Runs","text":"<p>Enforcement validation SHOULD run: - On pull request creation - On pull request updates (new commits) - Before merge (CI/CD gate) - (Optional) As pre-commit hook</p> <p>Enforcement MAY be skipped for: - Documentation-only changes (when <code>allowNoDecisionForDocsOnly: true</code>) - Automated dependency updates (configurable) - Hotfix branches (policy decision)</p>"},{"location":"standard/enforcement/#configuration-files","title":"Configuration Files","text":""},{"location":"standard/enforcement/#primary-provenanceconfigjson","title":"Primary: <code>provenance/config.json</code>","text":"<p>This file defines paths, thresholds, and basic requirements:</p> <pre><code>{\n  \"decisionPath\": \"provenance/decisions\",\n  \"riskPath\": \"provenance/risks\",\n  \"mistakePath\": \"provenance/mistakes\",\n  \"specPath\": \"provenance/specs\",\n  \"indexesPath\": \"provenance/indexes\",\n  \"enforcementPolicyPath\": \"provenance/policies/enforcement.yml\",\n\n  \"requireDecisionOnPaths\": [\n    \"src/\",\n    \"infra/\",\n    \"security/\"\n  ],\n  \"requireDecisionOnLabels\": [\n    \"security\",\n    \"breaking-change\",\n    \"architecture\"\n  ],\n  \"allowNoDecisionForDocsOnly\": true,\n\n  \"requireRiskOnPaths\": [\n    \"**/auth/**\",\n    \"**/security/**\",\n    \"**/permissions/**\",\n    \"**/crypto/**\"\n  ],\n  \"requireRiskOnLabels\": [\n    \"risk-accepted\",\n    \"security-waiver\"\n  ],\n  \"allowNoRiskForDocsOnly\": true,\n\n  \"requireSpecOnPaths\": [\n    \"src/\"\n  ],\n  \"requireSpecOnLabels\": [\n    \"feature\",\n    \"enhancement\"\n  ],\n  \"allowNoSpecForDocsOnly\": true,\n\n  \"riskApprovalThreshold\": \"medium\",\n  \"specRiskDecisionThreshold\": \"medium\"\n}\n</code></pre>"},{"location":"standard/enforcement/#policy-provenancepoliciesenforcementyml","title":"Policy: <code>provenance/policies/enforcement.yml</code>","text":"<p>This file defines the enforcement preset and detailed rules:</p> <pre><code>version: 2\npreset: standard\nblocking:\n  mode: selective\n\nspecs:\n  requireOnLabels:\n    - feature\n    - enhancement\n    - breaking-change\n  requireOnPaths:\n    - src/api/\n    - src/core/\n    - frontend/state/\n  allowNoSpecForDocsOnly: true\n  requiredStatus:\n    - review\n    - approved\n  acceptanceCriteriaRequired: false\n  driftDetection: warn\n\ndecisions:\n  requireOnLabels:\n    - security\n    - breaking-change\n    - risk-high\n  requireOnPaths:\n    - auth/\n    - payments/\n    - infra/\n  allowNoDecisionForDocsOnly: true\n  requireOnSpecRisk: medium\n  statusByRisk:\n    low: draft\n    medium: draft\n    high: accepted\n\nrisks:\n  requireOnLabels:\n    - risk-accepted\n    - security-waiver\n  requireOnPaths:\n    - \"**/auth/**\"\n    - \"**/security/**\"\n    - \"**/permissions/**\"\n    - \"**/crypto/**\"\n  allowNoRiskForDocsOnly: true\n\ncoherence:\n  requireDecisionSpecLink: true\n\nai:\n  attributionRequired: false\n  attributionPattern: \"AI Attribution\"\n</code></pre>"},{"location":"standard/enforcement/#constitution-provenancepoliciesconstitutionmd","title":"Constitution: <code>provenance/policies/constitution.md</code>","text":"<p>Human-readable explanation of the three presets. Not parsed, but documents intent.</p>"},{"location":"standard/enforcement/#enforcement-presets","title":"Enforcement Presets","text":""},{"location":"standard/enforcement/#light-preset","title":"Light Preset","text":"<p>Philosophy: Move fast with advisory governance</p> <p>Characteristics: - Blocking: <code>never</code> by default - Missing items produce warnings only - Bot role: advisor - Suitable for: Startups, MVPs, early-stage projects</p> <p>Behavior: <pre><code>preset: light\nblocking:\n  mode: never\n\nspecs:\n  requireOnLabels: [feature]  # recommended, not required\n  requiredStatus: [draft, review, approved]\n  driftDetection: off\n\ndecisions:\n  requireOnLabels: [security, breaking-change]  # warn only\n  statusByRisk:\n    low: draft\n    medium: draft\n    high: draft  # acceptance not required\n\nai:\n  attributionRequired: false\n</code></pre></p> <p>What Gets Validated: - Decision format (if present) - Spec format (if present) - Links (if present)</p> <p>What Doesn't Block: - Missing decisions - Missing specs - Missing risk acceptances - Draft-state decisions</p>"},{"location":"standard/enforcement/#standard-preset-recommended","title":"Standard Preset (Recommended)","text":"<p>Philosophy: Specs drive work, decisions guard risk</p> <p>Characteristics: - Blocking: <code>selective</code> (missing required items blocks) - Bot role: gatekeeper - Suitable for: Production teams, scale-ups, SaaS products</p> <p>Behavior: <pre><code>preset: standard\nblocking:\n  mode: selective\n\nspecs:\n  requireOnLabels: [feature, enhancement, breaking-change]\n  requireOnPaths: [src/api/, src/core/, frontend/state/]\n  requiredStatus: [review, approved]  # no drafts\n  acceptanceCriteriaRequired: false\n  driftDetection: warn\n\ndecisions:\n  requireOnLabels: [security, breaking-change, risk-high]\n  requireOnPaths: [auth/, payments/, infra/]\n  requireOnSpecRisk: medium  # specs with medium+ risk need decision\n  statusByRisk:\n    low: draft        # low risk: draft OK\n    medium: draft     # medium risk: draft OK (but review recommended)\n    high: accepted    # high risk: must be accepted\n\nrisks:\n  requireOnLabels: [risk-accepted, security-waiver]\n  requireOnPaths: [\"**/auth/**\", \"**/security/**\"]\n\ncoherence:\n  requireDecisionSpecLink: true  # decisions must reference specs\n\nai:\n  attributionRequired: false\n</code></pre></p> <p>What Gets Blocked: - Changes to sensitive paths without decisions - Feature PRs without specs - High-risk decisions not in <code>accepted</code> state - Invalid decision/spec links</p> <p>What Still Allows Merge: - Draft decisions for low/medium risk - Documentation-only changes - Changes to non-sensitive paths</p>"},{"location":"standard/enforcement/#regulated-preset","title":"Regulated Preset","text":"<p>Philosophy: Nothing ships without provenance</p> <p>Characteristics: - Blocking: <code>always</code> (missing required items blocks) - Bot role: authority - Suitable for: Enterprise, safety-critical, regulated industries (healthcare, finance)</p> <p>Behavior: <pre><code>preset: regulated\nblocking:\n  mode: always\n\nspecs:\n  requireOnLabels: [\"*\"]  # all labeled PRs\n  requireOnPaths: [\"src/\", \"infra/\", \"config/\"]\n  allowNoSpecForDocsOnly: true  # only exception\n  requiredStatus: [approved]  # must be fully approved\n  acceptanceCriteriaRequired: true  # specs must have acceptance criteria\n  driftDetection: block  # block if diff doesn't match spec scope\n\ndecisions:\n  requireOnLabels: [security, breaking-change, risk-high, architecture, compliance]\n  requireOnPaths: [src/, infra/, security/, models/]\n  requireOnSpecRisk: low  # any spec with risk needs decision\n  statusByRisk:\n    low: accepted     # even low risk needs acceptance\n    medium: accepted\n    high: accepted\n    critical: accepted\n\nrisks:\n  requireOnLabels: [risk-accepted, security-waiver, compliance-exception]\n  requireOnPaths: [\"**/auth/**\", \"**/security/**\", \"**/permissions/**\", \"**/crypto/**\", \"**/data/**\"]\n\ncoherence:\n  requireDecisionSpecLink: true\n  requireSpecAcceptanceCriteria: true\n  requireReceiptForDecisions: true  # cryptographic receipt required\n\nai:\n  attributionRequired: true  # must declare AI involvement\n  attributionPattern: \"AI Attribution\"\n</code></pre></p> <p>What Gets Blocked: - Any non-doc PR without a spec - Any decision not in <code>accepted</code> state - Specs without acceptance criteria - Changes to spec scope without updating spec - Missing AI attribution when AI was involved</p> <p>No Exceptions Except: - Pure documentation changes (README, comments)</p>"},{"location":"standard/enforcement/#validation-rules","title":"Validation Rules","text":""},{"location":"standard/enforcement/#decision-validation","title":"Decision Validation","text":"<ol> <li>Format Validation</li> <li><code>decision.json</code> exists and is valid JSON</li> <li>Matches JSON schema</li> <li> <p>Required fields present</p> </li> <li> <p>ID Validation</p> </li> <li>Folder name matches <code>id</code> field</li> <li>ID format is <code>DEC-XXXXXX</code></li> <li> <p>ID is unique</p> </li> <li> <p>State Validation</p> </li> <li><code>lifecycle.state</code> is valid</li> <li> <p>State meets policy requirements</p> <ul> <li>Light: any state allowed</li> <li>Standard: <code>draft</code> or higher for low/medium risk, <code>accepted</code> for high risk</li> <li>Regulated: <code>accepted</code> required</li> </ul> </li> <li> <p>Link Validation</p> </li> <li>If <code>requireDecisionSpecLink: true</code>, decision MUST reference a spec</li> <li>Referenced specs MUST exist</li> <li> <p>PR number/URL MUST match current PR (if configured)</p> </li> <li> <p>Timestamp Validation</p> </li> <li><code>created_at</code> is valid ISO 8601</li> <li><code>accepted_at</code> present if state is <code>accepted</code></li> <li><code>accepted_at</code> is after <code>created_at</code></li> </ol>"},{"location":"standard/enforcement/#spec-validation","title":"Spec Validation","text":"<ol> <li>Format Validation</li> <li><code>spec.json</code> exists and is valid JSON</li> <li> <p>Matches JSON schema</p> </li> <li> <p>Status Validation</p> </li> <li> <p>Status meets preset requirements:</p> <ul> <li>Light: any status</li> <li>Standard: <code>review</code> or <code>approved</code></li> <li>Regulated: <code>approved</code> only</li> </ul> </li> <li> <p>Acceptance Criteria</p> </li> <li> <p>If <code>acceptanceCriteriaRequired: true</code>, spec MUST have acceptance criteria</p> </li> <li> <p>Risk-Decision Coherence</p> </li> <li>If spec risk level \u2265 <code>specRiskDecisionThreshold</code>, a decision MUST be linked</li> </ol>"},{"location":"standard/enforcement/#risk-validation","title":"Risk Validation","text":"<ol> <li>Format Validation</li> <li><code>risk.json</code> exists and is valid JSON</li> <li> <p>Matches JSON schema</p> </li> <li> <p>Expiration Check</p> </li> <li> <p>If <code>expires_at</code> is present and past, validation SHOULD warn or block</p> </li> <li> <p>Decision Link</p> </li> <li>Risk SHOULD be referenced by at least one decision</li> </ol>"},{"location":"standard/enforcement/#drift-detection","title":"Drift Detection","text":"<p>Drift occurs when the PR diff doesn't match the spec's <code>affectedPaths</code>:</p> <pre><code>driftDetection: off     # Don't check\ndriftDetection: warn    # Log warning, allow merge\ndriftDetection: block   # Block merge\n</code></pre> <p>Example:</p> <pre><code>// spec.json\n{\n  \"affectedPaths\": [\"src/api/\", \"src/models/\"]\n}\n</code></pre> <p>If PR changes <code>src/database/</code> but spec doesn't mention it, drift is detected.</p>"},{"location":"standard/enforcement/#path-and-label-triggers","title":"Path and Label Triggers","text":""},{"location":"standard/enforcement/#path-matching","title":"Path Matching","text":"<p>Paths support glob patterns:</p> <pre><code>\"requireDecisionOnPaths\": [\n  \"src/\",              // exact prefix\n  \"**/auth/**\",        // any depth\n  \"infra/*.tf\",        // specific file types\n  \"!docs/**\"           // exclusion\n]\n</code></pre>"},{"location":"standard/enforcement/#label-matching","title":"Label Matching","text":"<p>Labels are exact string matches:</p> <pre><code>\"requireDecisionOnLabels\": [\n  \"security\",\n  \"breaking-change\",\n  \"architecture\"\n]\n</code></pre>"},{"location":"standard/enforcement/#docs-only-detection","title":"Docs-Only Detection","text":"<p>If <code>allowNoDecisionForDocsOnly: true</code>, enforcement is skipped when ALL changed files match:</p> <pre><code>**/*.md\n**/docs/**\n**/README*\n**/LICENSE\n</code></pre>"},{"location":"standard/enforcement/#blocking-modes","title":"Blocking Modes","text":""},{"location":"standard/enforcement/#never-block","title":"Never Block","text":"<pre><code>blocking:\n  mode: never\n</code></pre> <p>All validation failures produce warnings in PR comments, but never block merge.</p>"},{"location":"standard/enforcement/#selective-block","title":"Selective Block","text":"<pre><code>blocking:\n  mode: selective\n</code></pre> <p>Block merge only when: - A required decision/spec/risk is missing - A decision/spec is in invalid state for the risk level - Links are broken or invalid</p> <p>Warnings are produced for: - Drift detection (unless <code>block</code> mode) - Recommendations (e.g., \"consider adding risk acceptance\")</p>"},{"location":"standard/enforcement/#always-block","title":"Always Block","text":"<pre><code>blocking:\n  mode: always\n</code></pre> <p>Any validation failure blocks merge. Used in regulated environments.</p>"},{"location":"standard/enforcement/#ai-attribution","title":"AI Attribution","text":""},{"location":"standard/enforcement/#purpose","title":"Purpose","text":"<p>Track when AI assistants contributed to decisions or implementation.</p>"},{"location":"standard/enforcement/#configuration","title":"Configuration","text":"<pre><code>ai:\n  attributionRequired: true\n  attributionPattern: \"AI Attribution\"\n</code></pre>"},{"location":"standard/enforcement/#implementation","title":"Implementation","text":"<p>When <code>attributionRequired: true</code>, the PR body or commit messages MUST contain the <code>attributionPattern</code> string.</p> <p>Example PR Body:</p> <pre><code>## Summary\n\nImplement GraphQL migration as per DEC-000042.\n\n## AI Attribution\n\nCursor AI assisted with:\n- Initial decision draft\n- Schema design\n- Migration script generation\n</code></pre>"},{"location":"standard/enforcement/#decision-bot-field","title":"Decision Bot Field","text":"<p>AI assistants SHOULD populate the <code>bot</code> field in decisions they create:</p> <pre><code>{\n  \"actors\": {\n    \"author\": \"user:alice\",\n    \"bot\": \"cursor-ai\",\n    \"approver\": \"user:bob\"\n  }\n}\n</code></pre>"},{"location":"standard/enforcement/#examples","title":"Examples","text":""},{"location":"standard/enforcement/#example-1-light-enforcement","title":"Example 1: Light Enforcement","text":"<p>A startup wants decision tracking but no blocking:</p> <p>provenance/config.json: <pre><code>{\n  \"requireDecisionOnPaths\": [\"src/\"],\n  \"requireDecisionOnLabels\": [\"security\"],\n  \"allowNoDecisionForDocsOnly\": true\n}\n</code></pre></p> <p>provenance/policies/enforcement.yml: <pre><code>preset: light\nblocking:\n  mode: never\ndecisions:\n  requireOnLabels: [security]\n  statusByRisk:\n    low: draft\n    medium: draft\n    high: draft\n</code></pre></p> <p>Result: All PRs produce warnings if missing decisions, but never block.</p>"},{"location":"standard/enforcement/#example-2-standard-enforcement","title":"Example 2: Standard Enforcement","text":"<p>A SaaS company wants governance on API and security changes:</p> <p>provenance/config.json: <pre><code>{\n  \"requireDecisionOnPaths\": [\"src/api/\", \"auth/\", \"payments/\"],\n  \"requireDecisionOnLabels\": [\"security\", \"breaking-change\"],\n  \"requireSpecOnLabels\": [\"feature\", \"enhancement\"]\n}\n</code></pre></p> <p>provenance/policies/enforcement.yml: <pre><code>preset: standard\nblocking:\n  mode: selective\nspecs:\n  requireOnLabels: [feature, enhancement]\n  requiredStatus: [review, approved]\ndecisions:\n  requireOnPaths: [auth/, payments/]\n  requireOnLabels: [security, breaking-change]\n  statusByRisk:\n    low: draft\n    medium: draft\n    high: accepted\n</code></pre></p> <p>Result: - Feature PRs need specs in review/approved state - Changes to auth/ or payments/ need decisions - High-risk decisions must be accepted - Other PRs pass through</p>"},{"location":"standard/enforcement/#example-3-regulated-enforcement","title":"Example 3: Regulated Enforcement","text":"<p>A healthcare company needs strict compliance:</p> <p>provenance/policies/enforcement.yml: <pre><code>preset: regulated\nblocking:\n  mode: always\nspecs:\n  requireOnPaths: [\"src/\"]\n  allowNoSpecForDocsOnly: true\n  requiredStatus: [approved]\n  acceptanceCriteriaRequired: true\ndecisions:\n  requireOnPaths: [\"src/\", \"infra/\"]\n  statusByRisk:\n    low: accepted\n    medium: accepted\n    high: accepted\ncoherence:\n  requireDecisionSpecLink: true\n  requireReceiptForDecisions: true\nai:\n  attributionRequired: true\n</code></pre></p> <p>Result: - Every code change needs an approved spec - Every spec needs an accepted decision - Acceptance receipts required - AI usage must be declared - Documentation is the only exception</p>"},{"location":"standard/enforcement/#migration-between-presets","title":"Migration Between Presets","text":"<p>Teams can graduate from Light \u2192 Standard \u2192 Regulated:</p> <ol> <li>Start Light</li> <li>Install ProvenanceCode</li> <li>Create decisions for major changes</li> <li> <p>Get comfortable with workflow</p> </li> <li> <p>Move to Standard</p> </li> <li>Add spec requirements for features</li> <li>Require accepted state for high-risk decisions</li> <li> <p>Enable selective blocking</p> </li> <li> <p>Adopt Regulated</p> </li> <li>Require acceptance for all decisions</li> <li>Add cryptographic receipts</li> <li>Enable AI attribution</li> <li>Block on drift detection</li> </ol>"},{"location":"standard/enforcement/#custom-presets","title":"Custom Presets","text":"<p>Teams MAY define custom presets by:</p> <ol> <li>Choosing a base preset (<code>light</code>, <code>standard</code>, or <code>regulated</code>)</li> <li>Overriding specific rules</li> <li>Documenting the custom preset in <code>constitution.md</code></li> </ol> <p>Example:</p> <pre><code>preset: standard-plus\nextends: standard\nblocking:\n  mode: selective\nspecs:\n  acceptanceCriteriaRequired: true  # stricter than standard\ndecisions:\n  statusByRisk:\n    medium: accepted  # stricter than standard\n</code></pre>"},{"location":"standard/enforcement/#validation-implementation","title":"Validation Implementation","text":""},{"location":"standard/enforcement/#validator-requirements","title":"Validator Requirements","text":"<p>A compliant validator MUST: 1. Read <code>provenance/config.json</code> and <code>provenance/policies/enforcement.yml</code> 2. Apply rules based on preset 3. Check path and label triggers 4. Validate artifact formats and states 5. Report results as warnings or errors 6. Return exit code 0 (pass) or non-zero (fail)</p>"},{"location":"standard/enforcement/#validator-outputs","title":"Validator Outputs","text":"<p>Validators SHOULD produce: - Console output for CI/CD logs - PR comments with validation results - Check run annotations (GitHub, GitLab) - Structured JSON for tooling integration</p> <p>Next: Repository Layout - Required directory structure See Also: Versioning - Lifecycle state management</p>"},{"location":"standard/repo-layout/","title":"Repository Layout Specification","text":"<p>Version: 1.0.0 Status: Draft Part of: ProvenanceCode Open Standard</p>"},{"location":"standard/repo-layout/#abstract","title":"Abstract","text":"<p>This document defines the required directory structure, file naming conventions, and organization patterns for ProvenanceCode-compliant repositories.</p>"},{"location":"standard/repo-layout/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Root Directory Structure</li> <li>Provenance Directory</li> <li>Decision Structure</li> <li>Risk Structure</li> <li>Mistake Structure</li> <li>Specification Structure</li> <li>Policy Files</li> <li>Supporting Directories</li> <li>File Naming Conventions</li> <li>Conformance Requirements</li> </ol>"},{"location":"standard/repo-layout/#overview","title":"Overview","text":"<p>ProvenanceCode uses a standardized directory structure to ensure: - Predictability - Tools know where to find artifacts - Separation - Different artifact types in dedicated directories - Scalability - Structure works from 1 to 10,000+ decisions - Git-friendly - Merge conflicts minimized through directory separation</p>"},{"location":"standard/repo-layout/#root-directory-structure","title":"Root Directory Structure","text":""},{"location":"standard/repo-layout/#minimal-conformance-level-1","title":"Minimal Conformance (Level 1)","text":"<pre><code>repository-root/\n\u251c\u2500\u2500 provenance/\n\u2502   \u251c\u2500\u2500 config.json          (REQUIRED)\n\u2502   \u2514\u2500\u2500 decisions/           (REQUIRED)\n\u2502       \u2514\u2500\u2500 DEC-000001/\n\u2502           \u2514\u2500\u2500 decision.json\n\u2514\u2500\u2500 (your project files)\n</code></pre>"},{"location":"standard/repo-layout/#standard-conformance-level-2","title":"Standard Conformance (Level 2)","text":"<pre><code>repository-root/\n\u251c\u2500\u2500 .provenancecode/\n\u2502   \u2514\u2500\u2500 ai-rules.md          (RECOMMENDED)\n\u251c\u2500\u2500 provenance/\n\u2502   \u251c\u2500\u2500 config.json          (REQUIRED)\n\u2502   \u251c\u2500\u2500 decisions/           (REQUIRED)\n\u2502   \u251c\u2500\u2500 risks/               (REQUIRED - directory exists)\n\u2502   \u251c\u2500\u2500 mistakes/            (REQUIRED - directory exists)\n\u2502   \u251c\u2500\u2500 specs/               (REQUIRED - directory exists)\n\u2502   \u251c\u2500\u2500 policies/            (REQUIRED)\n\u2502   \u2502   \u251c\u2500\u2500 enforcement.yml\n\u2502   \u2502   \u2514\u2500\u2500 constitution.md\n\u2502   \u251c\u2500\u2500 drafts/              (RECOMMENDED)\n\u2502   \u2514\u2500\u2500 links/               (OPTIONAL)\n\u2514\u2500\u2500 (your project files)\n</code></pre>"},{"location":"standard/repo-layout/#full-conformance-level-3","title":"Full Conformance (Level 3)","text":"<pre><code>repository-root/\n\u251c\u2500\u2500 .provenancecode/\n\u2502   \u251c\u2500\u2500 ai-rules.md          (REQUIRED)\n\u2502   \u2514\u2500\u2500 validation-config.json\n\u251c\u2500\u2500 .github/                  or .gitlab/\n\u2502   \u251c\u2500\u2500 workflows/\n\u2502   \u2502   \u2514\u2500\u2500 provenance-check.yml\n\u2502   \u2514\u2500\u2500 pull_request_template.md\n\u251c\u2500\u2500 provenance/\n\u2502   \u251c\u2500\u2500 config.json\n\u2502   \u251c\u2500\u2500 decisions/\n\u2502   \u2502   \u251c\u2500\u2500 DEC-000001/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 decision.json\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 decision.md\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 acceptance.receipt.json\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 prov.jsonld\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 c2pa.manifest.json\n\u2502   \u2502   \u2514\u2500\u2500 DEC-000002/\n\u2502   \u251c\u2500\u2500 risks/\n\u2502   \u2502   \u251c\u2500\u2500 RA-000001/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 risk.json\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 risk.md\n\u2502   \u2502   \u2514\u2500\u2500 RA-000002/\n\u2502   \u251c\u2500\u2500 mistakes/\n\u2502   \u2502   \u251c\u2500\u2500 MR-000001/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 mistake.json\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 mistake.md\n\u2502   \u2502   \u2514\u2500\u2500 MR-000002/\n\u2502   \u251c\u2500\u2500 specs/\n\u2502   \u2502   \u251c\u2500\u2500 SPEC-000001/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 spec.json\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 spec.md\n\u2502   \u2502   \u2514\u2500\u2500 SPEC-000002/\n\u2502   \u251c\u2500\u2500 policies/\n\u2502   \u2502   \u251c\u2500\u2500 constitution.md\n\u2502   \u2502   \u251c\u2500\u2500 enforcement.yml\n\u2502   \u2502   \u2514\u2500\u2500 mistakes-enforcement.json\n\u2502   \u251c\u2500\u2500 drafts/\n\u2502   \u2502   \u251c\u2500\u2500 DEC-000003-draft.md\n\u2502   \u2502   \u251c\u2500\u2500 SPEC-000003-draft.md\n\u2502   \u2502   \u2514\u2500\u2500 README.md\n\u2502   \u251c\u2500\u2500 links/\n\u2502   \u2502   \u251c\u2500\u2500 .gitkeep\n\u2502   \u2502   \u2514\u2500\u2500 external-references.json\n\u2502   \u251c\u2500\u2500 indexes/\n\u2502   \u2502   \u251c\u2500\u2500 learnings.index.json\n\u2502   \u2502   \u2514\u2500\u2500 tags.index.json\n\u2502   \u2514\u2500\u2500 schema/              (OPTIONAL - for custom schemas)\n\u2502       \u251c\u2500\u2500 decision.schema.json\n\u2502       \u2514\u2500\u2500 risk.schema.json\n\u2514\u2500\u2500 (your project files)\n</code></pre>"},{"location":"standard/repo-layout/#provenance-directory","title":"Provenance Directory","text":""},{"location":"standard/repo-layout/#location","title":"Location","text":"<p>The provenance directory MUST be at the repository root:</p> <pre><code>/provenance/\n</code></pre> <p>Alternative locations are NOT supported for Level 1 or Level 2 conformance.</p>"},{"location":"standard/repo-layout/#purpose","title":"Purpose","text":"<p>Central location for all decision evidence, risks, mistakes, and specifications.</p>"},{"location":"standard/repo-layout/#subdirectories","title":"Subdirectories","text":"Directory Required Purpose <code>decisions/</code> Level 1+ Decision Evidence Objects <code>risks/</code> Level 2+ Risk acceptance records <code>mistakes/</code> Level 2+ Mistake records and guardrails <code>specs/</code> Level 2+ Specification documents <code>policies/</code> Level 2+ Enforcement and governance rules <code>drafts/</code> Recommended Work-in-progress artifacts <code>links/</code> Optional Cross-reference indexes <code>indexes/</code> Optional Searchable indexes (tags, learnings) <code>schema/</code> Optional Custom JSON schemas"},{"location":"standard/repo-layout/#decision-structure","title":"Decision Structure","text":""},{"location":"standard/repo-layout/#directory-pattern","title":"Directory Pattern","text":"<p>Each decision MUST have its own directory:</p> <pre><code>provenance/decisions/DEC-XXXXXX/\n</code></pre> <p>Where <code>XXXXXX</code> is a zero-padded 6-digit number (000001\u2013999999).</p>"},{"location":"standard/repo-layout/#decision-files","title":"Decision Files","text":"<pre><code>provenance/decisions/DEC-000042/\n\u251c\u2500\u2500 decision.json               (REQUIRED - source of truth)\n\u251c\u2500\u2500 decision.md                 (RECOMMENDED - human narrative)\n\u251c\u2500\u2500 acceptance.receipt.json     (OPTIONAL - cryptographic proof)\n\u251c\u2500\u2500 prov.jsonld                 (OPTIONAL - W3C PROV format)\n\u251c\u2500\u2500 c2pa.manifest.json          (OPTIONAL - C2PA credentials)\n\u2514\u2500\u2500 evidence/                   (OPTIONAL - supporting files)\n    \u251c\u2500\u2500 diagram.png\n    \u251c\u2500\u2500 benchmark-results.csv\n    \u2514\u2500\u2500 meeting-notes.md\n</code></pre>"},{"location":"standard/repo-layout/#file-requirements-by-conformance-level","title":"File Requirements by Conformance Level","text":"File Level 1 Level 2 Level 3 <code>decision.json</code> \u2705 Required \u2705 Required \u2705 Required <code>decision.md</code> \u26a0\ufe0f Recommended \u26a0\ufe0f Recommended \u2705 Required <code>acceptance.receipt.json</code> \u2b1c Optional \u2b1c Optional \u2705 Required <code>prov.jsonld</code> \u2b1c Optional \u2b1c Optional \u2b1c Optional <code>c2pa.manifest.json</code> \u2b1c Optional \u2b1c Optional \u2b1c Optional"},{"location":"standard/repo-layout/#example-layout","title":"Example Layout","text":"<pre><code>provenance/decisions/\n\u251c\u2500\u2500 DEC-000001/\n\u2502   \u251c\u2500\u2500 decision.json\n\u2502   \u2514\u2500\u2500 decision.md\n\u251c\u2500\u2500 DEC-000002/\n\u2502   \u251c\u2500\u2500 decision.json\n\u2502   \u251c\u2500\u2500 decision.md\n\u2502   \u251c\u2500\u2500 acceptance.receipt.json\n\u2502   \u2514\u2500\u2500 evidence/\n\u2502       \u2514\u2500\u2500 architecture-diagram.png\n\u251c\u2500\u2500 DEC-000003/\n\u2502   \u251c\u2500\u2500 decision.json\n\u2502   \u2514\u2500\u2500 decision.md\n\u2514\u2500\u2500 README.md                  (Optional - index of decisions)\n</code></pre>"},{"location":"standard/repo-layout/#risk-structure","title":"Risk Structure","text":""},{"location":"standard/repo-layout/#directory-pattern_1","title":"Directory Pattern","text":"<pre><code>provenance/risks/RA-XXXXXX/\n</code></pre>"},{"location":"standard/repo-layout/#risk-files","title":"Risk Files","text":"<pre><code>provenance/risks/RA-000015/\n\u251c\u2500\u2500 risk.json                  (REQUIRED - source of truth)\n\u251c\u2500\u2500 risk.md                    (RECOMMENDED - human description)\n\u2514\u2500\u2500 evidence/                  (OPTIONAL - supporting files)\n    \u251c\u2500\u2500 vulnerability-scan.pdf\n    \u2514\u2500\u2500 risk-analysis.xlsx\n</code></pre>"},{"location":"standard/repo-layout/#example-layout_1","title":"Example Layout","text":"<pre><code>provenance/risks/\n\u251c\u2500\u2500 RA-000001/\n\u2502   \u251c\u2500\u2500 risk.json\n\u2502   \u2514\u2500\u2500 risk.md\n\u251c\u2500\u2500 RA-000002/\n\u2502   \u251c\u2500\u2500 risk.json\n\u2502   \u251c\u2500\u2500 risk.md\n\u2502   \u2514\u2500\u2500 evidence/\n\u2502       \u2514\u2500\u2500 threat-model.pdf\n\u2514\u2500\u2500 README.md                  (Optional)\n</code></pre>"},{"location":"standard/repo-layout/#risk-fields-reference","title":"Risk Fields Reference","text":"<p>The <code>risk.json</code> file MUST include: - <code>ra_id</code> - Risk acceptance ID (RA-XXXXXX) - <code>title</code> - Brief description - <code>status</code> - Current state (active, expired, mitigated, rejected) - <code>risk_statement</code> - Clear description of the risk - <code>severity</code> - Risk level (low, medium, high, critical) - <code>likelihood</code> - Probability (low, medium, high) - <code>acceptance</code> - Who accepted and when - <code>mitigations</code> - Risk reduction strategies - <code>links.decisions</code> - Decisions that reference this risk</p>"},{"location":"standard/repo-layout/#mistake-structure","title":"Mistake Structure","text":""},{"location":"standard/repo-layout/#directory-pattern_2","title":"Directory Pattern","text":"<pre><code>provenance/mistakes/MR-XXXXXX/\n</code></pre>"},{"location":"standard/repo-layout/#mistake-files","title":"Mistake Files","text":"<pre><code>provenance/mistakes/MR-000003/\n\u251c\u2500\u2500 mistake.json               (REQUIRED - source of truth)\n\u251c\u2500\u2500 mistake.md                 (RECOMMENDED - post-mortem)\n\u2514\u2500\u2500 evidence/                  (OPTIONAL - incident artifacts)\n    \u251c\u2500\u2500 logs.txt\n    \u251c\u2500\u2500 timeline.md\n    \u2514\u2500\u2500 root-cause-analysis.pdf\n</code></pre>"},{"location":"standard/repo-layout/#example-layout_2","title":"Example Layout","text":"<pre><code>provenance/mistakes/\n\u251c\u2500\u2500 MR-000001/\n\u2502   \u251c\u2500\u2500 mistake.json\n\u2502   \u2514\u2500\u2500 mistake.md\n\u251c\u2500\u2500 MR-000002/\n\u2502   \u251c\u2500\u2500 mistake.json\n\u2502   \u251c\u2500\u2500 mistake.md\n\u2502   \u2514\u2500\u2500 evidence/\n\u2502       \u251c\u2500\u2500 incident-logs.txt\n\u2502       \u2514\u2500\u2500 postmortem-slides.pdf\n\u2514\u2500\u2500 README.md                  (Optional)\n</code></pre>"},{"location":"standard/repo-layout/#mistake-fields-reference","title":"Mistake Fields Reference","text":"<p>The <code>mistake.json</code> file MUST include: - <code>mr_id</code> - Mistake record ID (MR-XXXXXX) - <code>title</code> - Brief description - <code>status</code> - Current state (open, mitigated, closed) - <code>severity</code> - Impact level (low, medium, high, critical) - <code>failure_type</code> - Category (bug, security, compliance, process) - <code>root_cause</code> - What went wrong and why - <code>fix</code> - How it was resolved - <code>prevent_rule</code> - Guardrail to prevent recurrence - <code>links.decisions</code> - Decisions created in response</p>"},{"location":"standard/repo-layout/#specification-structure","title":"Specification Structure","text":""},{"location":"standard/repo-layout/#directory-pattern_3","title":"Directory Pattern","text":"<pre><code>provenance/specs/SPEC-XXXXXX/\n</code></pre>"},{"location":"standard/repo-layout/#spec-files","title":"Spec Files","text":"<pre><code>provenance/specs/SPEC-000028/\n\u251c\u2500\u2500 spec.json                  (REQUIRED - source of truth)\n\u251c\u2500\u2500 spec.md                    (RECOMMENDED - detailed requirements)\n\u2514\u2500\u2500 artifacts/                 (OPTIONAL - mockups, diagrams)\n    \u251c\u2500\u2500 wireframes.fig\n    \u251c\u2500\u2500 api-schema.yml\n    \u2514\u2500\u2500 acceptance-tests.md\n</code></pre>"},{"location":"standard/repo-layout/#example-layout_3","title":"Example Layout","text":"<pre><code>provenance/specs/\n\u251c\u2500\u2500 SPEC-000001/\n\u2502   \u251c\u2500\u2500 spec.json\n\u2502   \u2514\u2500\u2500 spec.md\n\u251c\u2500\u2500 SPEC-000002/\n\u2502   \u251c\u2500\u2500 spec.json\n\u2502   \u251c\u2500\u2500 spec.md\n\u2502   \u2514\u2500\u2500 artifacts/\n\u2502       \u251c\u2500\u2500 user-flows.png\n\u2502       \u2514\u2500\u2500 api-spec.yml\n\u2514\u2500\u2500 README.md                  (Optional)\n</code></pre>"},{"location":"standard/repo-layout/#spec-fields-reference","title":"Spec Fields Reference","text":"<p>The <code>spec.json</code> file MUST include: - <code>id</code> - Specification ID (SPEC-XXXXXX) - <code>title</code> - Brief description - <code>status</code> - Current state (draft, review, approved, implemented, rejected) - <code>risk</code> - Risk level associated with implementation - <code>acceptanceCriteria</code> - List of requirements for completion - <code>affectedPaths</code> - Code paths this spec impacts - <code>relatedDecisions</code> - Implementing decision IDs</p>"},{"location":"standard/repo-layout/#policy-files","title":"Policy Files","text":""},{"location":"standard/repo-layout/#location_1","title":"Location","text":"<pre><code>provenance/policies/\n</code></pre>"},{"location":"standard/repo-layout/#required-files-level-2","title":"Required Files (Level 2+)","text":"<pre><code>provenance/policies/\n\u251c\u2500\u2500 constitution.md            (REQUIRED - human-readable governance)\n\u251c\u2500\u2500 enforcement.yml            (REQUIRED - validation rules)\n\u2514\u2500\u2500 mistakes-enforcement.json  (RECOMMENDED - guardrail policy)\n</code></pre>"},{"location":"standard/repo-layout/#file-purposes","title":"File Purposes","text":"File Purpose <code>constitution.md</code> Documents the three presets (Light, Standard, Regulated) and team philosophy <code>enforcement.yml</code> Machine-readable enforcement rules and thresholds <code>mistakes-enforcement.json</code> Rules for validating mistake record references"},{"location":"standard/repo-layout/#example-content","title":"Example Content","text":"<p>constitution.md: <pre><code># Enforcement Philosophy\n\nWe use the **Standard** preset because...\n\n## When Decisions Required\n- Security changes\n- Architecture changes\n- Breaking changes\n\n## When Specs Required\n- New features\n- API changes\n- Database migrations\n</code></pre></p> <p>enforcement.yml: <pre><code>version: 2\npreset: standard\nblocking:\n  mode: selective\ndecisions:\n  requireOnLabels: [security, breaking-change]\n  requireOnPaths: [src/api/, auth/]\n</code></pre></p>"},{"location":"standard/repo-layout/#supporting-directories","title":"Supporting Directories","text":""},{"location":"standard/repo-layout/#drafts-directory","title":"Drafts Directory","text":"<p>Location: <code>provenance/drafts/</code></p> <p>Purpose: Work-in-progress artifacts not yet finalized</p> <p>Contents: <pre><code>provenance/drafts/\n\u251c\u2500\u2500 DEC-000005-draft.md\n\u251c\u2500\u2500 SPEC-000010-draft.md\n\u251c\u2500\u2500 RA-000003-draft.json\n\u2514\u2500\u2500 README.md              (Template instructions)\n</code></pre></p> <p>Rules: - Draft files are NOT enforced by validation - File naming: <code>{TYPE}-{ID}-draft.{ext}</code> - Move to proper directory when finalized</p>"},{"location":"standard/repo-layout/#links-directory","title":"Links Directory","text":"<p>Location: <code>provenance/links/</code></p> <p>Purpose: Cross-references to external systems (Jira, Linear, Slack, etc.)</p> <p>Contents: <pre><code>provenance/links/\n\u251c\u2500\u2500 .gitkeep\n\u251c\u2500\u2500 jira-mapping.json      (Decision ID \u2192 Jira key)\n\u251c\u2500\u2500 slack-threads.json     (Decision ID \u2192 Slack URL)\n\u2514\u2500\u2500 external-refs.json     (Generic external links)\n</code></pre></p>"},{"location":"standard/repo-layout/#indexes-directory","title":"Indexes Directory","text":"<p>Location: <code>provenance/indexes/</code></p> <p>Purpose: Searchable indexes for fast lookups</p> <p>Contents: <pre><code>provenance/indexes/\n\u251c\u2500\u2500 learnings.index.json   (Lessons learned from mistakes)\n\u251c\u2500\u2500 tags.index.json        (All tags across artifacts)\n\u251c\u2500\u2500 by-author.index.json   (Artifacts by author)\n\u2514\u2500\u2500 by-date.index.json     (Chronological index)\n</code></pre></p> <p>Example learnings.index.json: <pre><code>{\n  \"version\": \"1.0\",\n  \"updated_at\": \"2026-02-12T10:00:00Z\",\n  \"learnings\": [\n    {\n      \"mr_id\": \"MR-000001\",\n      \"title\": \"Missing input validation\",\n      \"category\": \"security\",\n      \"prevent_rule\": \"All user input must be validated\",\n      \"linked_decisions\": [\"DEC-000025\"]\n    }\n  ]\n}\n</code></pre></p>"},{"location":"standard/repo-layout/#file-naming-conventions","title":"File Naming Conventions","text":""},{"location":"standard/repo-layout/#id-formats","title":"ID Formats","text":"Artifact Type ID Format Example Decision <code>DEC-XXXXXX</code> <code>DEC-000042</code> Risk <code>RA-XXXXXX</code> <code>RA-000015</code> Mistake <code>MR-XXXXXX</code> <code>MR-000003</code> Specification <code>SPEC-XXXXXX</code> <code>SPEC-000028</code>"},{"location":"standard/repo-layout/#directory-names","title":"Directory Names","text":"<ul> <li>MUST match the ID exactly</li> <li>MUST be uppercase</li> <li>MUST include leading zeros</li> </ul> <p>\u2705 Good: <pre><code>provenance/decisions/DEC-000001/\nprovenance/risks/RA-000042/\n</code></pre></p> <p>\u274c Bad: <pre><code>provenance/decisions/dec-1/           # Wrong case, missing zeros\nprovenance/decisions/DEC-000001-foo/  # Extra suffix\n</code></pre></p>"},{"location":"standard/repo-layout/#file-names","title":"File Names","text":"File Purpose Naming Pattern Example Primary artifact <code>{type}.json</code> <code>decision.json</code>, <code>risk.json</code> Markdown narrative <code>{type}.md</code> <code>decision.md</code>, <code>spec.md</code> Acceptance receipt <code>acceptance.receipt.json</code> (exact name) W3C PROV <code>prov.jsonld</code> (exact name) C2PA manifest <code>c2pa.manifest.json</code> (exact name) Draft <code>{ID}-draft.{ext}</code> <code>DEC-000005-draft.md</code> Evidence (any) <code>diagram.png</code>, <code>logs.txt</code>"},{"location":"standard/repo-layout/#conformance-requirements","title":"Conformance Requirements","text":""},{"location":"standard/repo-layout/#level-1-decision-records-only","title":"Level 1: Decision Records Only","text":"<p>MUST have: - <code>/provenance/</code> directory at root - <code>/provenance/config.json</code> file - <code>/provenance/decisions/</code> directory - At least one valid decision: <code>/provenance/decisions/DEC-000001/decision.json</code></p> <p>Example: <pre><code>repo-root/\n\u251c\u2500\u2500 provenance/\n\u2502   \u251c\u2500\u2500 config.json\n\u2502   \u2514\u2500\u2500 decisions/\n\u2502       \u2514\u2500\u2500 DEC-000001/\n\u2502           \u2514\u2500\u2500 decision.json\n\u2514\u2500\u2500 src/\n</code></pre></p>"},{"location":"standard/repo-layout/#level-2-standard-compliance","title":"Level 2: Standard Compliance","text":"<p>MUST have all Level 1 requirements, plus: - <code>/provenance/risks/</code> directory (may be empty) - <code>/provenance/mistakes/</code> directory (may be empty) - <code>/provenance/specs/</code> directory (may be empty) - <code>/provenance/policies/enforcement.yml</code> - <code>/provenance/policies/constitution.md</code></p> <p>Example: <pre><code>repo-root/\n\u251c\u2500\u2500 provenance/\n\u2502   \u251c\u2500\u2500 config.json\n\u2502   \u251c\u2500\u2500 decisions/\n\u2502   \u251c\u2500\u2500 risks/\n\u2502   \u251c\u2500\u2500 mistakes/\n\u2502   \u251c\u2500\u2500 specs/\n\u2502   \u2514\u2500\u2500 policies/\n\u2502       \u251c\u2500\u2500 enforcement.yml\n\u2502       \u2514\u2500\u2500 constitution.md\n\u2514\u2500\u2500 src/\n</code></pre></p>"},{"location":"standard/repo-layout/#level-3-full-provenance","title":"Level 3: Full Provenance","text":"<p>MUST have all Level 2 requirements, plus: - <code>/.provenancecode/ai-rules.md</code> - At least one decision with <code>acceptance.receipt.json</code> - At least one mistake record - At least one risk acceptance - <code>/provenance/drafts/</code> directory - <code>/provenance/indexes/</code> directory with at least <code>learnings.index.json</code></p>"},{"location":"standard/repo-layout/#migration-and-growth","title":"Migration and Growth","text":""},{"location":"standard/repo-layout/#starting-small","title":"Starting Small","text":"<p>Begin with Level 1: <pre><code>mkdir -p provenance/decisions\ntouch provenance/config.json\n</code></pre></p>"},{"location":"standard/repo-layout/#adding-structure","title":"Adding Structure","text":"<p>Grow to Level 2: <pre><code>mkdir -p provenance/{risks,mistakes,specs,policies,drafts}\ntouch provenance/policies/enforcement.yml\ntouch provenance/policies/constitution.md\n</code></pre></p>"},{"location":"standard/repo-layout/#full-adoption","title":"Full Adoption","text":"<p>Reach Level 3: <pre><code>mkdir -p .provenancecode\nmkdir -p provenance/indexes\ntouch .provenancecode/ai-rules.md\ntouch provenance/indexes/learnings.index.json\n</code></pre></p>"},{"location":"standard/repo-layout/#platform-specific-notes","title":"Platform-Specific Notes","text":""},{"location":"standard/repo-layout/#github","title":"GitHub","text":"<ul> <li>Use <code>.github/workflows/</code> for validation actions</li> <li>Use <code>.github/pull_request_template.md</code> for PR template</li> </ul>"},{"location":"standard/repo-layout/#gitlab","title":"GitLab","text":"<ul> <li>Use <code>.gitlab-ci.yml</code> for validation pipeline</li> <li>Use <code>.gitlab/merge_request_templates/</code> for MR template</li> </ul>"},{"location":"standard/repo-layout/#bitbucket","title":"Bitbucket","text":"<ul> <li>Use <code>bitbucket-pipelines.yml</code> for validation</li> <li>Use pull request description template feature</li> </ul> <p>All platforms work with the same <code>/provenance/</code> structure.</p>"},{"location":"standard/repo-layout/#best-practices","title":"Best Practices","text":"<ol> <li>Keep flat - Don't nest subdirectories within decision folders (except <code>/evidence/</code>)</li> <li>One artifact per directory - Don't combine multiple decisions in one folder</li> <li>Sequential IDs - Assign IDs in order for easier browsing</li> <li>README files - Add optional README.md files to directories for navigation</li> <li>Gitignore evidence - Optionally exclude large binary files from <code>/evidence/</code></li> </ol> <p>Next: Versioning and Lifecycle - Managing artifact states See Also: Decision Evidence Objects (DEO) - Decision file formats</p>"},{"location":"standard/versioning/","title":"Versioning and Lifecycle Specification","text":"<p>Version: 1.0.0 Status: Draft Part of: ProvenanceCode Open Standard</p>"},{"location":"standard/versioning/#abstract","title":"Abstract","text":"<p>This document defines how ProvenanceCode artifacts progress through lifecycle states, how versions are managed, and how decisions evolve or become superseded over time.</p>"},{"location":"standard/versioning/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Lifecycle States</li> <li>State Transitions</li> <li>Versioning Rules</li> <li>Supersession</li> <li>Expiration</li> <li>Artifact-Specific Lifecycles</li> <li>Best Practices</li> <li>Examples</li> </ol>"},{"location":"standard/versioning/#overview","title":"Overview","text":"<p>ProvenanceCode artifacts (decisions, specs, risks, mistakes) follow defined lifecycles that track their progression from initial draft to final state. This ensures:</p> <ul> <li>Clarity - Everyone knows the current status</li> <li>Auditability - State changes are tracked</li> <li>Immutability - Accepted artifacts are never edited, only superseded</li> <li>Traceability - History is preserved through supersession chains</li> </ul>"},{"location":"standard/versioning/#lifecycle-states","title":"Lifecycle States","text":""},{"location":"standard/versioning/#decision-states","title":"Decision States","text":"State Description Can Edit? Terminal? <code>draft</code> Initial creation, work in progress \u2705 Yes \u274c No <code>proposed</code> Ready for review, awaiting approval \u26a0\ufe0f Minor edits \u274c No <code>accepted</code> Approved and active \u274c No \u274c No <code>rejected</code> Not approved, will not implement \u274c No \u2705 Yes <code>superseded</code> Replaced by newer decision \u274c No \u2705 Yes"},{"location":"standard/versioning/#specification-states","title":"Specification States","text":"State Description Can Edit? Terminal? <code>draft</code> Initial requirements, under discussion \u2705 Yes \u274c No <code>review</code> Ready for stakeholder review \u26a0\ufe0f Minor edits \u274c No <code>approved</code> Accepted, ready for implementation \u274c No \u274c No <code>implemented</code> Completed and deployed \u274c No \u2705 Yes <code>rejected</code> Not moving forward \u274c No \u2705 Yes <code>superseded</code> Replaced by newer spec \u274c No \u2705 Yes"},{"location":"standard/versioning/#risk-acceptance-states","title":"Risk Acceptance States","text":"State Description Can Edit? Terminal? <code>active</code> Risk is currently accepted \u26a0\ufe0f Update mitigations \u274c No <code>expired</code> Acceptance period ended \u274c No \u26a0\ufe0f Review needed <code>mitigated</code> Risk has been eliminated \u274c No \u2705 Yes <code>rejected</code> Risk not accepted \u274c No \u2705 Yes"},{"location":"standard/versioning/#mistake-record-states","title":"Mistake Record States","text":"State Description Can Edit? Terminal? <code>open</code> Identified, not yet fixed \u26a0\ufe0f Add details \u274c No <code>mitigated</code> Prevention rules in place \u26a0\ufe0f Add learnings \u274c No <code>closed</code> Fully resolved, guardrails active \u274c No \u2705 Yes"},{"location":"standard/versioning/#state-transitions","title":"State Transitions","text":""},{"location":"standard/versioning/#decision-lifecycle-flow","title":"Decision Lifecycle Flow","text":"<pre><code>   draft\n     \u2193\n  proposed\n   \u2199   \u2198\naccepted  rejected\n   \u2193         (terminal)\nsuperseded\n (terminal)\n</code></pre>"},{"location":"standard/versioning/#valid-transitions","title":"Valid Transitions","text":"From To Condition <code>draft</code> <code>proposed</code> Ready for review <code>draft</code> <code>rejected</code> Decided not to proceed <code>proposed</code> <code>accepted</code> Approval granted <code>proposed</code> <code>rejected</code> Approval denied <code>proposed</code> <code>draft</code> Needs more work <code>accepted</code> <code>superseded</code> New decision replaces this"},{"location":"standard/versioning/#invalid-transitions","title":"Invalid Transitions","text":"<p>\u274c Cannot transition: - From <code>accepted</code> back to <code>draft</code> or <code>proposed</code> (must supersede instead) - From <code>rejected</code> to any other state (terminal) - From <code>superseded</code> to any other state (terminal)</p>"},{"location":"standard/versioning/#versioning-rules","title":"Versioning Rules","text":""},{"location":"standard/versioning/#version-numbers","title":"Version Numbers","text":"<p>Each artifact has a <code>version</code> field (integer starting at 1):</p> <pre><code>{\n  \"id\": \"DEC-000042\",\n  \"version\": 1\n}\n</code></pre>"},{"location":"standard/versioning/#when-to-increment-version","title":"When to Increment Version","text":"<p>Increment the version number when making substantive changes to: - Outcome or decision - Risk level - Acceptance criteria (specs) - Mitigations (risks)</p> <p>Do NOT increment for: - Typo fixes - Formatting changes - Adding links or tags - Updating timestamps</p>"},{"location":"standard/versioning/#version-history","title":"Version History","text":"<p>Store version history in <code>timestamps.updated_at</code>:</p> <pre><code>{\n  \"version\": 3,\n  \"timestamps\": {\n    \"created_at\": \"2026-02-01T10:00:00Z\",\n    \"accepted_at\": \"2026-02-02T14:30:00Z\",\n    \"updated_at\": \"2026-02-10T09:15:00Z\"\n  }\n}\n</code></pre> <p>For detailed history, optionally create: <pre><code>provenance/decisions/DEC-000042/\n\u251c\u2500\u2500 decision.json           (current version)\n\u251c\u2500\u2500 decision.v1.json        (previous version)\n\u251c\u2500\u2500 decision.v2.json        (previous version)\n\u2514\u2500\u2500 CHANGELOG.md            (version history)\n</code></pre></p>"},{"location":"standard/versioning/#supersession","title":"Supersession","text":""},{"location":"standard/versioning/#purpose","title":"Purpose","text":"<p>When an accepted decision needs substantial changes, supersede it instead of editing:</p> <ol> <li>Create a new decision with new ID</li> <li>Mark old decision as <code>superseded</code></li> <li>Link old \u2194 new with <code>lifecycle.supersedes</code> and <code>lifecycle.superseded_by</code></li> </ol>"},{"location":"standard/versioning/#supersession-fields","title":"Supersession Fields","text":"<p>Old Decision (DEC-000010): <pre><code>{\n  \"id\": \"DEC-000010\",\n  \"version\": 1,\n  \"lifecycle\": {\n    \"state\": \"superseded\",\n    \"superseded_by\": \"DEC-000042\"\n  }\n}\n</code></pre></p> <p>New Decision (DEC-000042): <pre><code>{\n  \"id\": \"DEC-000042\",\n  \"version\": 1,\n  \"lifecycle\": {\n    \"state\": \"accepted\",\n    \"supersedes\": \"DEC-000010\"\n  }\n}\n</code></pre></p>"},{"location":"standard/versioning/#supersession-chains","title":"Supersession Chains","text":"<p>Decisions can form chains:</p> <pre><code>DEC-000010 (superseded)\n    \u2193\nDEC-000042 (superseded)\n    \u2193\nDEC-000081 (accepted) \u2014 current\n</code></pre> <p>DEC-000081: <pre><code>{\n  \"lifecycle\": {\n    \"state\": \"accepted\",\n    \"supersedes\": \"DEC-000042\"\n  },\n  \"supersession_chain\": [\"DEC-000010\", \"DEC-000042\"]\n}\n</code></pre></p>"},{"location":"standard/versioning/#when-to-supersede-vs-update","title":"When to Supersede vs. Update","text":"Scenario Action Typo in rationale \u270f\ufe0f Edit and increment version Add missing link \u270f\ufe0f Edit without version increment Change outcome \ud83d\udd04 Supersede with new decision Change risk level \ud83d\udd04 Supersede with new decision Reverse decision \ud83d\udd04 Supersede with new decision <p>Rule of thumb: If it changes what was decided or why, supersede. If it's just clarification, update.</p>"},{"location":"standard/versioning/#expiration","title":"Expiration","text":""},{"location":"standard/versioning/#purpose_1","title":"Purpose","text":"<p>Some decisions and risk acceptances have time limits: - Temporary workarounds - Trial periods - Time-boxed experiments - Compliance waivers</p>"},{"location":"standard/versioning/#expiration-field","title":"Expiration Field","text":"<pre><code>{\n  \"timestamps\": {\n    \"created_at\": \"2026-02-01T00:00:00Z\",\n    \"accepted_at\": \"2026-02-01T00:00:00Z\",\n    \"expires_at\": \"2026-08-01T00:00:00Z\"\n  }\n}\n</code></pre>"},{"location":"standard/versioning/#handling-expiration","title":"Handling Expiration","text":"<p>When <code>expires_at</code> is in the past:</p> <ol> <li>Validator behavior:</li> <li>Light preset: warn</li> <li>Standard preset: warn</li> <li> <p>Regulated preset: block</p> </li> <li> <p>Team action:</p> </li> <li>Review the decision/risk</li> <li>Either:<ul> <li>Extend expiration (update <code>expires_at</code>)</li> <li>Make permanent (remove <code>expires_at</code>)</li> <li>Supersede with new decision</li> <li>Mark as <code>expired</code> (for risks)</li> </ul> </li> </ol>"},{"location":"standard/versioning/#expiration-notifications","title":"Expiration Notifications","text":"<p>Optional: Create automation to notify teams of upcoming expirations:</p> <pre><code># Example: Find decisions expiring in next 30 days\njq -r 'select(.timestamps.expires_at and \n  (.timestamps.expires_at | fromdateiso8601) &lt; (now + 30*24*60*60)) | \n  .id' provenance/decisions/*/decision.json\n</code></pre>"},{"location":"standard/versioning/#artifact-specific-lifecycles","title":"Artifact-Specific Lifecycles","text":""},{"location":"standard/versioning/#decision-lifecycle-details","title":"Decision Lifecycle Details","text":"<p>Draft State: - Use for exploring options - AI assistants create drafts automatically - Can be freely edited - Not enforced by validation</p> <p>Proposed State: - Submitted for review - Minor edits allowed (typos, clarifications) - Substantive changes \u2192 back to draft - Reviewers provide feedback</p> <p>Accepted State: - Approval granted - No longer editable - Active and enforced - Can only be superseded</p> <p>Best Practices: - Keep decisions in draft until implementation starts - Move to proposed when PR is ready - Accept only after human approval - Supersede if decision changes after acceptance</p>"},{"location":"standard/versioning/#specification-lifecycle-details","title":"Specification Lifecycle Details","text":"<p>Draft State: - Requirements gathering - Stakeholder input - Can change freely</p> <p>Review State: - Ready for approval - Stakeholders confirm requirements - Minor adjustments allowed</p> <p>Approved State: - Ready for implementation - No changes without new spec - Linked to implementing decision</p> <p>Implemented State: - Code deployed to production - Terminal state - Serves as historical record</p> <p>Best Practices: - Create spec before starting work - Move to review when complete - Approve before significant implementation - Mark implemented when deployed</p>"},{"location":"standard/versioning/#risk-acceptance-lifecycle-details","title":"Risk Acceptance Lifecycle Details","text":"<p>Active State: - Risk is currently accepted - Mitigations are in place - Monitor regularly - Update mitigations as needed</p> <p>Expired State: - Acceptance period ended - Requires review - Either renew or mitigate</p> <p>Mitigated State: - Risk eliminated - Successful outcome - Document lessons learned</p> <p>Best Practices: - Set expiration dates for all non-permanent risks - Review active risks monthly - Document mitigation strategies - Link to implementing decisions</p>"},{"location":"standard/versioning/#mistake-record-lifecycle-details","title":"Mistake Record Lifecycle Details","text":"<p>Open State: - Incident documented - Root cause identified - Prevention rule drafted</p> <p>Mitigated State: - Guardrails in place - Enforcement active - Monitoring impact</p> <p>Closed State: - Fully resolved - No recurrence - Lessons captured</p> <p>Best Practices: - Create mistake records for all significant incidents - Define clear prevention rules - Link to enforcement policy - Review quarterly for effectiveness</p>"},{"location":"standard/versioning/#best-practices","title":"Best Practices","text":""},{"location":"standard/versioning/#1-start-in-draft","title":"1. Start in Draft","text":"<p>Always create new artifacts in draft state:</p> <pre><code>{\n  \"lifecycle\": {\n    \"state\": \"draft\"\n  },\n  \"timestamps\": {\n    \"created_at\": \"2026-02-12T10:00:00Z\"\n  }\n}\n</code></pre>"},{"location":"standard/versioning/#2-update-timestamps","title":"2. Update Timestamps","text":"<p>Set timestamps when changing states:</p> <pre><code>{\n  \"lifecycle\": {\n    \"state\": \"accepted\"\n  },\n  \"timestamps\": {\n    \"created_at\": \"2026-02-12T10:00:00Z\",\n    \"accepted_at\": \"2026-02-14T15:30:00Z\"\n  }\n}\n</code></pre>"},{"location":"standard/versioning/#3-record-actors","title":"3. Record Actors","text":"<p>Track who made state transitions:</p> <pre><code>{\n  \"lifecycle\": {\n    \"state\": \"accepted\"\n  },\n  \"actors\": {\n    \"author\": \"user:alice\",\n    \"approver\": \"user:bob\"\n  }\n}\n</code></pre>"},{"location":"standard/versioning/#4-use-supersession-chains","title":"4. Use Supersession Chains","text":"<p>When superseding, maintain full chain:</p> <pre><code>{\n  \"lifecycle\": {\n    \"supersedes\": \"DEC-000042\"\n  },\n  \"supersession_chain\": [\"DEC-000010\", \"DEC-000042\"],\n  \"rationale\": \"Updated authentication approach based on new security requirements. Previous decisions (DEC-000010, DEC-000042) are superseded.\"\n}\n</code></pre>"},{"location":"standard/versioning/#5-document-state-changes","title":"5. Document State Changes","text":"<p>In <code>decision.md</code>, document major state changes:</p> <pre><code>## Version History\n\n### Version 2 (2026-02-14)\n- **State Change:** draft \u2192 accepted\n- **Reason:** Team approved GraphQL migration approach\n- **Approver:** @bob\n\n### Version 1 (2026-02-12)\n- **Created:** Initial draft\n- **Author:** @alice\n</code></pre>"},{"location":"standard/versioning/#6-handle-expiration-proactively","title":"6. Handle Expiration Proactively","text":"<p>For expiring decisions:</p> <pre><code>{\n  \"timestamps\": {\n    \"expires_at\": \"2026-06-01T00:00:00Z\"\n  },\n  \"expiration_note\": \"Temporary workaround for payment provider migration. Review before June 1, 2026.\"\n}\n</code></pre>"},{"location":"standard/versioning/#examples","title":"Examples","text":""},{"location":"standard/versioning/#example-1-decision-evolution","title":"Example 1: Decision Evolution","text":"<p>Initial Draft: <pre><code>{\n  \"id\": \"DEC-000042\",\n  \"version\": 1,\n  \"lifecycle\": {\n    \"state\": \"draft\"\n  },\n  \"timestamps\": {\n    \"created_at\": \"2026-02-10T10:00:00Z\"\n  }\n}\n</code></pre></p> <p>After Review: <pre><code>{\n  \"id\": \"DEC-000042\",\n  \"version\": 2,\n  \"lifecycle\": {\n    \"state\": \"proposed\"\n  },\n  \"timestamps\": {\n    \"created_at\": \"2026-02-10T10:00:00Z\",\n    \"updated_at\": \"2026-02-12T14:30:00Z\"\n  }\n}\n</code></pre></p> <p>After Acceptance: <pre><code>{\n  \"id\": \"DEC-000042\",\n  \"version\": 2,\n  \"lifecycle\": {\n    \"state\": \"accepted\"\n  },\n  \"timestamps\": {\n    \"created_at\": \"2026-02-10T10:00:00Z\",\n    \"accepted_at\": \"2026-02-13T09:15:00Z\",\n    \"updated_at\": \"2026-02-12T14:30:00Z\"\n  },\n  \"actors\": {\n    \"author\": \"user:alice\",\n    \"approver\": \"user:bob\"\n  }\n}\n</code></pre></p>"},{"location":"standard/versioning/#example-2-supersession","title":"Example 2: Supersession","text":"<p>Old Decision Marked as Superseded: <pre><code>{\n  \"id\": \"DEC-000010\",\n  \"title\": \"Use JWT for authentication\",\n  \"version\": 1,\n  \"lifecycle\": {\n    \"state\": \"superseded\",\n    \"superseded_by\": \"DEC-000042\"\n  },\n  \"timestamps\": {\n    \"created_at\": \"2025-06-01T10:00:00Z\",\n    \"accepted_at\": \"2025-06-05T14:00:00Z\",\n    \"superseded_at\": \"2026-02-13T09:15:00Z\"\n  }\n}\n</code></pre></p> <p>New Decision: <pre><code>{\n  \"id\": \"DEC-000042\",\n  \"title\": \"Migrate from JWT to OAuth2 with session tokens\",\n  \"version\": 1,\n  \"lifecycle\": {\n    \"state\": \"accepted\",\n    \"supersedes\": \"DEC-000010\"\n  },\n  \"timestamps\": {\n    \"created_at\": \"2026-02-10T10:00:00Z\",\n    \"accepted_at\": \"2026-02-13T09:15:00Z\"\n  },\n  \"rationale\": \"OAuth2 provides better security and refresh token support. Supersedes DEC-000010 which used simpler JWT approach.\"\n}\n</code></pre></p>"},{"location":"standard/versioning/#example-3-risk-expiration","title":"Example 3: Risk Expiration","text":"<p>Active Risk with Expiration: <pre><code>{\n  \"ra_id\": \"RA-000015\",\n  \"status\": \"active\",\n  \"timestamps\": {\n    \"created_at\": \"2026-02-01T00:00:00Z\",\n    \"expires_at\": \"2026-05-01T00:00:00Z\"\n  },\n  \"risk_statement\": \"Temporary use of deprecated API until migration complete\",\n  \"acceptance\": {\n    \"accepted_by\": \"team-lead\",\n    \"accepted_at\": \"2026-02-01T00:00:00Z\",\n    \"expires_at\": \"2026-05-01T00:00:00Z\",\n    \"reason\": \"Migration in progress, target completion April 2026\"\n  }\n}\n</code></pre></p> <p>After Expiration (needs review): <pre><code>{\n  \"ra_id\": \"RA-000015\",\n  \"status\": \"expired\",\n  \"timestamps\": {\n    \"created_at\": \"2026-02-01T00:00:00Z\",\n    \"expires_at\": \"2026-05-01T00:00:00Z\",\n    \"expired_at\": \"2026-05-01T00:00:00Z\"\n  },\n  \"review_note\": \"Migration delayed, need to extend acceptance or expedite migration\"\n}\n</code></pre></p>"},{"location":"standard/versioning/#example-4-mistake-record-lifecycle","title":"Example 4: Mistake Record Lifecycle","text":"<p>Open Mistake: <pre><code>{\n  \"mr_id\": \"MR-000003\",\n  \"status\": \"open\",\n  \"timestamps\": {\n    \"created_at\": \"2026-02-12T10:00:00Z\"\n  },\n  \"root_cause\": {\n    \"summary\": \"Missing input validation allowed SQL injection\"\n  },\n  \"prevent_rule\": {\n    \"rule_id\": \"PRV-MR-000003-validate-all-inputs\",\n    \"statement\": \"All user inputs must be validated and sanitized before database queries\"\n  }\n}\n</code></pre></p> <p>After Fix: <pre><code>{\n  \"mr_id\": \"MR-000003\",\n  \"status\": \"mitigated\",\n  \"timestamps\": {\n    \"created_at\": \"2026-02-12T10:00:00Z\",\n    \"mitigated_at\": \"2026-02-14T15:00:00Z\"\n  },\n  \"fix\": {\n    \"pr\": \"https://github.com/org/repo/pull/456\",\n    \"commit\": \"abc123\",\n    \"summary\": \"Added input validation library and updated all query builders\"\n  },\n  \"enforcement\": [\n    {\n      \"kind\": \"linter\",\n      \"ref\": \"eslint-plugin-security\",\n      \"must_exist\": true\n    }\n  ]\n}\n</code></pre></p> <p>Fully Resolved: <pre><code>{\n  \"mr_id\": \"MR-000003\",\n  \"status\": \"closed\",\n  \"timestamps\": {\n    \"created_at\": \"2026-02-12T10:00:00Z\",\n    \"mitigated_at\": \"2026-02-14T15:00:00Z\",\n    \"closed_at\": \"2026-03-01T10:00:00Z\"\n  },\n  \"closure_note\": \"Validation in place for 2 weeks, no recurrence, enforcement automated\"\n}\n</code></pre></p>"},{"location":"standard/versioning/#validation-requirements","title":"Validation Requirements","text":"<p>Validators SHOULD check:</p> <ol> <li>Valid States:</li> <li> <p><code>lifecycle.state</code> is one of the defined states for the artifact type</p> </li> <li> <p>Timestamp Consistency:</p> </li> <li><code>created_at</code> \u2264 <code>accepted_at</code> \u2264 <code>updated_at</code></li> <li> <p><code>expires_at</code> (if present) &gt; <code>accepted_at</code></p> </li> <li> <p>Supersession Integrity:</p> </li> <li>If <code>supersedes</code> is present, referenced artifact exists</li> <li> <p>If <code>superseded_by</code> is present, that artifact references this one</p> </li> <li> <p>Terminal States:</p> </li> <li>Artifacts in terminal states cannot transition further</li> <li> <p>Terminal artifacts should not be edited</p> </li> <li> <p>Expiration Warnings:</p> </li> <li>Warn or block if <code>expires_at</code> is past and state is still <code>active</code>/<code>accepted</code></li> </ol> <p>Next: Implementation Guides - How to use ProvenanceCode See Also: Decision Evidence Objects (DEO) - Decision format details</p>"}]}